<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Nginx ç½‘ç»œåè®® æºç åˆ†æ DNS äº‘è®¡ç®—">
<meta name="description" content="">
<meta name="theme-color" content="#000">
<title>yyçš„å°ç«™</title>
<link rel="shortcut icon" href="/favicon.ico?v=1588165674470">
<link rel="stylesheet" href="/styles/main.css">
<link rel="stylesheet" href="/media/css/gemini.css">

<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/github.css"
  rel="stylesheet">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163205066-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-163205066-1');
</script>


<script>
  var _hmt = _hmt || [];
  (function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?1be048b8c5c87a450b605c349e64ca47";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class=" gemini">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>yyçš„å°ç«™</span>
            </a>  
          
        </div>
        
          <p class="subtitle">Keep Learning, Keep Sharing.</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
            <li class="nav-item nav-item-active">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout  gemini">
      <div class="section-layout-wrapper">
        <div id="sidebarMeta" class="sidebar">
    
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">yyçš„å°ç«™</p>
    <p class="site-description right-motion">Day day up!</p>
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">4</span>
        <span class="site-item-stat-name">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">4</span>
        <span class="site-item-stat-name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">4</span>
        <span class="site-item-stat-name">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
    
      <div class="sidebar-item">
        <span class="site-item-rss">
            <i class="fa fa-rss"></i>
            <a href="https://xly0713.github.io/atom.xml" target="_blank">RSS</a>
        </span>
      </div>
    
  
  
    <div class="sidebar-item sidebar-item-social">
      <div class="social-item">
        
          
            <a href="https://github.com/xly0713">
              <i class="fa fa-github-alt" title="Github"></i>
            </a>
          
        
        
      </div>
    </div>
  

  


</div>
</div>
<script>
  let sidebarMeta = document.querySelector('#sidebarMeta');
  let scheme = 'gemini';
  let sidebarWrapper = document.querySelector('.sidebar-wrapper');
  if (sidebarMeta && (scheme === 'pisces' || scheme === 'gemini')) {
    document.addEventListener('scroll', function(e) {
      if (document.scrollingElement.scrollTop > parseInt(sidebarMeta.style.marginTop) + 10) {
        sidebarWrapper.classList.add('home-sidebar-fixed')
      } else {
        sidebarWrapper.classList.remove('home-sidebar-fixed')
      }
    });
  }
  </script>
        <div class="section-box box-shadow-wrapper">
          <section class="section tags-section bg-color posts-expand">
            <div class="tags-box">
  <div class="tag-cloud-title">
    ç›®å‰å…±è®¡ 4 ä¸ªæ ‡ç­¾
  </div>
  <div class="tag-cloud-list" id="tags">
    
      
      
        
          
            
      
        
          
            
      
        
          
        
      
        
          
        
          
        
      
        
      
      <a class="cloud-tag" href="https://xly0713.github.io/tag/ZUZBgmRmp/" rel="2">Nginx</a>
    
      
      
        
          
        
          
            
      
        
          
        
      
        
          
        
      
        
          
        
          
        
      
        
      
      <a class="cloud-tag" href="https://xly0713.github.io/tag/1FH1KPhrG/" rel="1">æºç åˆ†æ</a>
    
      
      
        
          
        
          
        
      
        
          
        
      
        
          
            
      
        
          
            
      
        
      
      <a class="cloud-tag" href="https://xly0713.github.io/tag/Q1k2X6rnU/" rel="2">ç½‘ç»œåè®®</a>
    
      
      
        
          
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
          
            
      
        
      
      <a class="cloud-tag" href="https://xly0713.github.io/tag/pRwAbJURI/" rel="1">GSLB</a>
    
  </div>
</div>
<script>

  let fontStart = 12, fontEnd = 30, colorStart = '#666', colorEnd = '#000';
  let tags = document.querySelector('#tags').children;
  let counts = [];
  for(let i = 0; i < tags.length; i++) {
    counts.push(tags[i].rel);
  }
  let lowest = Math.min.apply(null,counts), highest = Math.max.apply(null,counts);;
  let range = highest - lowest;
  if (range === 0) {
    range = 1;
  }
  let fontIncr, colorIncr;
  fontIncr = (fontEnd - fontStart) / range;
  
  let sColorArr = toRGB(colorStart), eColorArr = toRGB(colorEnd);

  for(let i = 0; i < tags.length; i++) {
    let disCount = tags[i].rel - lowest;
    let fontSize = fontStart + disCount * fontIncr;
    let style = 'font-size: ' + fontSize + 'px;';
    let arr = [];
    for(let c = 0; c < sColorArr.length; c++) {
      if (disCount === 0) {
        disCount = 1;
      }
      let val = (sColorArr[c] - eColorArr[c]) / range * disCount;
      if (val >= 100) {
        val = eColorArr[c];
      } else if (val <= 0) {
        val = sColorArr[c];
      }
      arr[c] = Math.floor(val);
    }
    style += 'color: ' + toHex(arr);
    tags[i].style = style;
  }

  function toRGB(code) {
    if (code.length === 4) {
      code = code.replace(/(\w)(\w)(\w)/gi, "\$1\$1\$2\$2\$3\$3");
    }
    var hex = /(\w{2})(\w{2})(\w{2})/.exec(code);
    return [parseInt(hex[1], 16), parseInt(hex[2], 16), parseInt(hex[3], 16)];
  }

  function toHex(ary) {
    return "#" + ((1 << 24) + (ary[0] << 16) + (ary[1] << 8) + ary[2]).toString(16).slice(1);
  }

</script>
          </section>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | Â© 2019-2020 Theme By <a href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      
    </div>
  </footer>
  
  
  <div class="gemini back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
  
    

<link rel="stylesheet" href="/media/live2d/histoire/css/live2d.css" />
<div class="box-scale">
  <div id="landlord" style="left: 5px;bottom: px;" data-key="">
    <div class="message" style="opacity:0"></div>
    <canvas id="live2d" width="500" height="560" class="live2d"></canvas>
    <div class="live_talk_input_body">
      <div class="live_talk_input_name_body">
        <input name="name" type="text" class="live_talk_name white_input" id="AIuserName" autocomplete="off" placeholder="ä½ çš„åå­—" />
      </div>
      <div class="live_talk_input_text_body">
        <input name="talk" type="text" class="live_talk_talk white_input" id="AIuserText" autocomplete="off" placeholder="è¦å’Œæˆ‘èŠä»€ä¹ˆå‘€ï¼Ÿ"/>
        <button type="button" class="live_talk_send_btn" id="talk_send">å‘é€</button>
      </div>
    </div>
    <input name="live_talk" id="live_talk" value="1" type="hidden" />
    <div class="live_ico_box">
      <div class="live_ico_item type_info" id="showInfoBtn"></div>
      <div class="live_ico_item type_talk" id="showTalkBtn"></div>
      
      <div class="live_ico_item type_youdu" id="youduButton"></div>
      <div class="live_ico_item type_quit" id="hideButton"></div>
      <input name="live_statu_val" id="live_statu_val" value="0" type="hidden" />
      <audio src="" style="display:none;" id="live2d_bgm" data-bgm="0" preload="none"></audio>
      <input id="duType" value="douqilai" type="hidden">
      
    </div>
  </div>
</div>
<div id="open_live2d">å¬å”¤ä¼Šæ–¯ç‰¹ç“¦å°”</div>
<script src="https://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script>
var message_Path = '/media/live2d/histoire/';
let landlord = document.querySelector('#landlord');
var apiKey = landlord.dataset.key;
</script>
<script type="text/javascript" src="/media/live2d/histoire/js/live2d.js"></script>
<script type="text/javascript" src="/media/live2d/histoire/js/message.js"></script>
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text'),
  drawerBox = document.querySelector('#drawer_box'),
  rightSideBar = document.querySelector('.sidebar'),
  viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  
  let hasCacu = false;
  window.onresize = function() {
    if (window.width > 991) {
      calcuHeight();
    } else {
      hasCacu = false;
    }
  }

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();
  
  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function() {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, transitionDir,{ });
          }
        })
        window.Velocity(viewport, openProp,{
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp ,{
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // é“¾æ¥è·³è½¬
  let newWindow = 'false'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target","_blank");
      }
    })
  }
  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();

</script>
  </div>
</body>
<input hidden id="copy" />
<script>
  //æ‹¿æ¥ä¸»ä¹‰(çœŸé¦™)^_^ï¼ŒClipboard å®ç°æ‘˜è‡ªæ˜é‡‘ https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        console.log('å¤åˆ¶æ“ä½œé¢‘ç‡è¿‡é«˜');
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })
</script>
<script src="/media/js/motion.js"></script>

<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 500
  });
</script>

<!-- <div class="search-mask" id="search_mask">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input type="text" placeholder="æœç´¢">
      </div>
      <i class="fa fa-times-circle"></i>
    </div>
    <div class="result">
      
      <div class="item">
        <a class="result-title" href="https://xly0713.github.io/post/nginx-yuan-ma-xue-xi/"" data-c="
          &lt;p&gt;Nginxä½œä¸ºé«˜æ€§èƒ½çš„webæœåŠ¡å™¨ï¼Œå®ƒæ˜¯å¦‚ä½•ç®¡ç†å†…å­˜çš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;å†…å­˜æ± çš„ä¼˜ç‚¹&#34;&gt;å†…å­˜æ± çš„ä¼˜ç‚¹&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;poolåŒ–å¤„ç†ï¼Œé¿å…å¤šæ¬¡å‘ç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œå‡å°‘ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢ï¼Œæé«˜å†…å­˜åˆ†é…æ•ˆç‡;&lt;/li&gt;
&lt;li&gt;å†…å­˜ç»Ÿä¸€åˆ†é…å’Œå›æ”¶ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼›&lt;/li&gt;
&lt;li&gt;æ•´å—åˆ†é…ï¼Œé¿å…å†…å­˜è¿‡äºç¢ç‰‡åŒ–;&lt;/li&gt;
&lt;li&gt;å†…å­˜å¯¹é½å¤„ç†ï¼Œå‡å°‘CPUè¯»å–å†…å­˜æ¬¡æ•°ï¼Œæé«˜å¯»å€æ•ˆç‡ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å†…å­˜æ± ç›¸å…³çš„æ•°æ®ç»“æ„&#34;&gt;å†…å­˜æ± ç›¸å…³çš„æ•°æ®ç»“æ„&lt;/h2&gt;
&lt;h3 id=&#34;ç»“æ„ä½“ç¤ºæ„å›¾&#34;&gt;ç»“æ„ä½“ç¤ºæ„å›¾&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://xly0713.github.io/post-images/1587183416580.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;æ•°æ®ç»“æ„å®šä¹‰&#34;&gt;æ•°æ®ç»“æ„å®šä¹‰&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;typedef struct ngx_pool_s            ngx_pool_t;
typedef struct ngx_pool_large_s  ngx_pool_large_t;

struct ngx_pool_s { //å†…å­˜æ± å¤´éƒ¨ç»“æ„
    ngx_pool_data_t       d;        //å†…å­˜æ± çš„æ•°æ®åŒºï¼Œå³çœŸæ­£åˆ†é…å†…å­˜çš„åŒºåŸŸ
    size_t                max;      //æ¯æ¬¡å¯åˆ†é…æœ€å¤§å†…å­˜ï¼Œç”¨äºåˆ¤å®šæ˜¯èµ°å¤§å†…å­˜åˆ†é…è¿˜æ˜¯å°å†…å­˜åˆ†é…é€»è¾‘
    ngx_pool_t           *current;  //æŒ‡å‘å½“å‰å†…å­˜æ± å°å—å†…å­˜å¯ç”¨çš„é¦–ä¸ªèŠ‚ç‚¹
    ngx_chain_t          *chain;    //ç¼“å†²åŒºé“¾è¡¨
    ngx_pool_large_t     *large;    //å†…å­˜å—å¤§äºmaxå†…å­˜å—çš„é“¾è¡¨
    ngx_pool_cleanup_t   *cleanup;  //é”€æ¯å†…å­˜æ± å›è°ƒå‡½æ•°
    ngx_log_t            *log;      //é”™è¯¯æ—¥å¿—æŒ‡é’ˆ
};

typedef struct {
    u_char               *last;     //å½“å‰å†…å­˜å—å·²ä½¿ç”¨åˆ°æ­¤å¤„ï¼Œä¸‹ä¸€æ¬¡ä½¿ç”¨ä»æ­¤å¤„å¼€å§‹
    u_char               *end;      //å†…å­˜å—ç»“æŸä½ç½®
    ngx_pool_t           *next;     //å†…å­˜æ± æœ‰å¾ˆå¤šå†…å­˜å—ï¼Œé€šè¿‡nextæŒ‡é’ˆç»„æˆé“¾è¡¨
    ngx_uint_t            failed;   //å†…å­˜å—åˆ†é…å¤±è´¥æ¬¡æ•°
} ngx_pool_data_t; //å°å†…å­˜å—(é“¾è¡¨)

//å¤§å†…å­˜å—(é“¾è¡¨)
struct ngx_pool_large_s {
    ngx_pool_large_t     *next;  //ä¸‹ä¸€æ•°æ®å—åœ°å€
    void                 *alloc; //å½“å‰æ•°æ®å—åœ°å€
};
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å†…å­˜æ± ä¸»è¦å‡½æ•°&#34;&gt;å†…å­˜æ± ä¸»è¦å‡½æ•°&lt;/h2&gt;
&lt;h3 id=&#34;æ–°å»ºå†…å­˜æ± &#34;&gt;æ–°å»ºå†…å­˜æ± &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/*
 * æ–°å»ºä¸€ä¸ªå†…å­˜æ± 
 */
ngx_pool_t *
ngx_create_pool(size_t size, ngx_log_t *log)
{
    ngx_pool_t  *p;

    //è°ƒç”¨ç³»ç»Ÿå†…å­˜åˆ†é…å‡½æ•°ï¼Œåˆ†é…ä¸€å—å †å†…å­˜ï¼Œä¸”åšå¯¹é½å¤„ç†
    p = ngx_memalign(NGX_POOL_ALIGNMENT, size, log);
    if (p == NULL) {
        return NULL;
    }

    p-&amp;gt;d.last = (u_char *) p + sizeof(ngx_pool_t);
    p-&amp;gt;d.end = (u_char *) p + size;
    p-&amp;gt;d.next = NULL;
    p-&amp;gt;d.failed = 0;

    size = size - sizeof(ngx_pool_t);
    //maxæœ€å¤§ä¸ºpagesize-1(æ¯”å¦‚:x86æ—¶ä¸º4095), å³ï¼šæ— è®ºå°å—å†…å­˜ç©ºé—´æ˜¯å¦è¶³å¤Ÿï¼Œè¶…è¿‡pagesize-1å¤§å°çš„å†…å­˜å‡èµ°largeå—åˆ†é…
    p-&amp;gt;max = (size &amp;lt; NGX_MAX_ALLOC_FROM_POOL) ? size : NGX_MAX_ALLOC_FROM_POOL;

    p-&amp;gt;current = p;
    p-&amp;gt;chain = NULL;
    p-&amp;gt;large = NULL;
    p-&amp;gt;cleanup = NULL;
    p-&amp;gt;log = log;

    return p;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ä»å†…å­˜æ± ç”³è¯·å†…å­˜&#34;&gt;ä»å†…å­˜æ± ç”³è¯·å†…å­˜&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆå¯¹é½å†åˆ†é…å†…å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;/*
 * ä»å†…å­˜æ± ä¸­ç”³è¯·ä¸€å—å†…å­˜
 * ï¼ˆ1ï¼‰å¦‚æœç”³è¯·çš„å†…å­˜å°äºå®šä¹‰çš„maxï¼Œåˆ™ä»å†…å­˜æ± ä¸­åˆ†é…å†…å­˜ï¼Œéœ€å…ˆå¯¹é½å†åˆ†é…
 * ï¼ˆ2ï¼‰å¦åˆ™åˆ†é…å¤§å—å†…å­˜æŒ‚è½½åˆ°largeæŒ‡é’ˆä¸Š
 */
void *
ngx_palloc(ngx_pool_t *pool, size_t size)
{
#if !(NGX_DEBUG_PALLOC)
    if (size &amp;lt;= pool-&amp;gt;max) {
        return ngx_palloc_small(pool, size, 1); //å°å—å†…å­˜(å…ˆå¯¹é½)
    }
#endif

    return ngx_palloc_large(pool, size);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆå¯¹é½å†åˆ†é…å†…å­˜, å¹¶å¡«å……0&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;/*
 * ä»å†…å­˜æ± ä¸­ç”³è¯·å†…å­˜ï¼Œå¹¶å¡«å……0
 */
void *
ngx_pcalloc(ngx_pool_t *pool, size_t size)
{
    void *p;

    p = ngx_palloc(pool, size);
    if (p) {
        ngx_memzero(p, size);
    }

    return p;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ç”¨å¯¹é½åˆ†é…å†…å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;/*
 * ä»å†…å­˜æ± ä¸­ç”³è¯·ä¸€å—å†…å­˜ ï¼ˆå°å—å†…å­˜æ— éœ€å…ˆå¯¹é½ï¼‰
 */
void *
ngx_pnalloc(ngx_pool_t *pool, size_t size)
{
#if !(NGX_DEBUG_PALLOC)
    if (size &amp;lt;= pool-&amp;gt;max) {
        return ngx_palloc_small(pool, size, 0); //å°å—å†…å­˜ï¼ˆæ— éœ€å…ˆå¯¹é½ï¼‰
    }
#endif

    return ngx_palloc_large(pool, size);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ä»å†…å­˜æ± ç”³è¯·å†…å­˜å°å—å†…å­˜&#34;&gt;ä»å†…å­˜æ± ç”³è¯·å†…å­˜å°å—å†…å­˜&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/*
 * åˆ†é…å°å—å†…å­˜
 * 1. å¾ªç¯éå†å†…å­˜å—ngx_pool_data_té“¾è¡¨
 * 2. å¦‚æœå½“å‰å†…å­˜å—å‰©ä½™å¤§å°æ»¡è¶³ç”³è¯·çš„å†…å­˜å¤§å°ï¼Œåˆ™ç§»åŠ¨ç›¸åº”æŒ‡é’ˆï¼Œè¿”å›åˆ†é…çš„å†…å­˜æŒ‡é’ˆ
 * 3. å¦åˆ™ï¼Œç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå†…å­˜å—
 * 4. å¦‚æœæ‰€æœ‰å†…å­˜å—éƒ½æ²¡èƒ½æ»¡è¶³ç”³è¯·çš„å†…å­˜å¤§å°ï¼Œåˆ™é‡æ–°ç”³è¯·ä¸€å—å†…å­˜å—æŒ‚è½½åˆ°é“¾è¡¨ä¸Šï¼Œå¹¶è¿”å›åˆ†é…çš„å†…å­˜åœ°å€
 */
static ngx_inline void *
ngx_palloc_small(ngx_pool_t *pool, size_t size, ngx_uint_t align)
{
    u_char      *m;
    ngx_pool_t  *p;

    p = pool-&amp;gt;current;

    do {
        m = p-&amp;gt;d.last; //æœ€åä½¿ç”¨ä½ç½®

        if (align) {
            m = ngx_align_ptr(m, NGX_ALIGNMENT); //å…ˆå†…å­˜å¯¹é½, å‡å°‘CPUè¯»å–å†…å­˜æ¬¡æ•°
        }

        if ((size_t) (p-&amp;gt;d.end - m) &amp;gt;= size) { //å½“å‰å†…å­˜å—å‰©ä½™ç©ºé—´è¶³å¤Ÿ
            p-&amp;gt;d.last = m + size; //æœ€åä½¿ç”¨ä½ç½®æ›´æ–°ï¼Œå‰©ä½™ç©ºé—´å˜å°

            return m;
        }

        p = p-&amp;gt;d.next;

    } while (p);

    //ç°æœ‰å°å—å†…å­˜å‡æ— æ³•åˆ†é…ï¼Œåˆ™æ–°å»ºå†…å­˜å—åå†åˆ†é…
    return ngx_palloc_block(pool, size);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;æ–°å»ºå°å†…å­˜å—å†åˆ†é…&#34;&gt;æ–°å»ºå°å†…å­˜å—å†åˆ†é…&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/*
 * å†æ¬¡ç”³è¯·å°å—å†…å­˜ï¼Œå¹¶æŒ‚è½½åˆ°å°å—å†…å­˜é“¾è¡¨ä¸Šï¼Œå¹¶è¿”å›å½“æ¬¡ç”³è¯·çš„å†…å­˜æŒ‡é’ˆ
*/
static void *
ngx_palloc_block(ngx_pool_t *pool, size_t size)
{
    u_char      *m;
    size_t       psize;
    ngx_pool_t  *p, *new;

    psize = (size_t) (pool-&amp;gt;d.end - (u_char *) pool);

    m = ngx_memalign(NGX_POOL_ALIGNMENT, psize, pool-&amp;gt;log);
    if (m == NULL) {
        return NULL;
    }

    new = (ngx_pool_t *) m;

    new-&amp;gt;d.end = m + psize;
    new-&amp;gt;d.next = NULL;
    new-&amp;gt;d.failed = 0;

    m += sizeof(ngx_pool_data_t);
    m = ngx_align_ptr(m, NGX_ALIGNMENT);
    new-&amp;gt;d.last = m + size;

    for (p = pool-&amp;gt;current; p-&amp;gt;d.next; p = p-&amp;gt;d.next) {
        //è°ƒæ•´å„ä¸ªå†…å­˜å—åˆ†é…å¤±è´¥æ¬¡æ•°ï¼Œå¦‚æœå¤±è´¥æ¬¡æ•°å¤§äº4ï¼Œåˆ™æ­¤å—å†…å­˜èŠ‚ç‚¹ä¸å†ä½¿ç”¨
        if (p-&amp;gt;d.failed++ &amp;gt; 4) {
            pool-&amp;gt;current = p-&amp;gt;d.next;
        }
    }

    p-&amp;gt;d.next = new;

    return m;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;åˆ†é…å¤§å†…å­˜&#34;&gt;åˆ†é…å¤§å†…å­˜&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/*
 * åˆ†é…å¤§å†…å­˜å—
 */
static void *
ngx_palloc_large(ngx_pool_t *pool, size_t size)
{
    void              *p;
    ngx_uint_t         n;
    ngx_pool_large_t  *large;

    p = ngx_alloc(size, pool-&amp;gt;log); //å‘ç³»ç»Ÿç”³è¯·sizeå¤§å°å †å†…å­˜
    if (p == NULL) {
        return NULL;
    }

    n = 0;

    //æŸ¥æ‰¾ä¸€ä¸ªç©ºçš„largeåŒºï¼Œå¦‚æœæœ‰ï¼Œåˆ™å°†åˆ†é…çš„ç©ºé—´päº¤ç”±å®ƒç®¡ç†ï¼ˆæœ€å¤š3æ¬¡ï¼‰
    for (large = pool-&amp;gt;large; large; large = large-&amp;gt;next) {
        if (large-&amp;gt;alloc == NULL) { //ngx_pfreeå‡½æ•°ä¼šäº§ç”Ÿç©ºçš„largeåŒº
            large-&amp;gt;alloc = p;
            return p;
        }

        if (n++ &amp;gt; 3) { //è¶…è¿‡ä¸€å®šæ¬¡æ•°ï¼Œæ”¾å¼ƒæŸ¥æ‰¾ç©ºçš„largeåŒº
            break;
        }
    }

    //åˆ›å»ºä¸€ä¸ªæ–°çš„largeèŠ‚ç‚¹
    large = ngx_palloc_small(pool, sizeof(ngx_pool_large_t), 1);
    if (large == NULL) {
        ngx_free(p);
        return NULL;
    }

    //æ–°åˆ†é…çš„ç©ºé—´päº¤ç”±æ–°å»ºçš„largeèŠ‚ç‚¹ç®¡ç†ï¼Œå¹¶ä¸”æ’å…¥åˆ°largeé“¾è¡¨å¤´éƒ¨
    large-&amp;gt;alloc = p;
    large-&amp;gt;next = pool-&amp;gt;large;
    pool-&amp;gt;large = large;

    return p;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é”€æ¯å†…å­˜æ± &#34;&gt;é”€æ¯å†…å­˜æ± &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/*
 * é”€æ¯å†…å­˜æ± 
 */
void
ngx_destroy_pool(ngx_pool_t *pool)
{
    ngx_pool_t          *p, *n;
    ngx_pool_large_t    *l;
    ngx_pool_cleanup_t  *c;

    for (c = pool-&amp;gt;cleanup; c; c = c-&amp;gt;next) {
        if (c-&amp;gt;handler) {
            ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0,
                           &amp;quot;run cleanup: %p&amp;quot;, c);
            c-&amp;gt;handler(c-&amp;gt;data);
        }
    }

#if (NGX_DEBUG)

    /*
     * we could allocate the pool-&amp;gt;log from this pool
     * so we cannot use this log while free()ing the pool
     */

    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) {
        ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0, &amp;quot;free: %p&amp;quot;, l-&amp;gt;alloc);
    }

    for (p = pool, n = pool-&amp;gt;d.next; /* void */; p = n, n = n-&amp;gt;d.next) {
        ngx_log_debug2(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0,
                       &amp;quot;free: %p, unused: %uz&amp;quot;, p, p-&amp;gt;d.end - p-&amp;gt;d.last);

        if (n == NULL) {
            break;
        }
    }

#endif

    //é‡Šæ”¾å¤§å†…å­˜å—ï¼ˆé“¾è¡¨ï¼‰
    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) {
        if (l-&amp;gt;alloc) {
            ngx_free(l-&amp;gt;alloc);
        }
    }

    //é‡Šæ”¾å°å†…å­˜å— (é“¾è¡¨)
    for (p = pool, n = pool-&amp;gt;d.next; /* void */; p = n, n = n-&amp;gt;d.next) {
        ngx_free(p);

        if (n == NULL) {
            break;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é‡ç½®å†…å­˜æ± &#34;&gt;é‡ç½®å†…å­˜æ± &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/*
 * é‡ç½®å†…å­˜æ± 
 * 1. é‡Šæ”¾å¤§å—å†…å­˜
 * 2. é‡ç½®å¯å¼€å§‹åˆ†é…ä½ç½®æŒ‡é’ˆã€åˆ†é…å¤±è´¥æ¬¡æ•°ä¸º0ã€å¯ç”¨å°å†…å­˜å—currentæŒ‡é’ˆæŒ‡å‘é¦–ä¸ªå†…å­˜å—
 */
void
ngx_reset_pool(ngx_pool_t *pool)
{
    ngx_pool_t        *p;
    ngx_pool_large_t  *l;

    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) { //éå†å¤§å—å†…å­˜é“¾è¡¨ï¼Œé‡Šæ”¾å†…å­˜
        if (l-&amp;gt;alloc) {
            ngx_free(l-&amp;gt;alloc);
        }
    }

    for (p = pool; p; p = p-&amp;gt;d.next) {
        p-&amp;gt;d.last = (u_char *) p + sizeof(ngx_pool_t); //æ¢å¤è‡³åˆå§‹ä¸ºä½ç½®
        p-&amp;gt;d.failed = 0; //åˆ†é…å¤±è´¥æ¬¡æ•°é‡ç½®ä¸º0
    }

    pool-&amp;gt;current = pool; //currentæŒ‡å‘é¦–ä¸ªå†…å­˜å—
    pool-&amp;gt;chain = NULL;
    pool-&amp;gt;large = NULL;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å›æ”¶å¤§å—å†…å­˜é“¾è¡¨ä¸Šçš„æŸä¸ªèŠ‚ç‚¹å†…å­˜&#34;&gt;å›æ”¶å¤§å—å†…å­˜é“¾è¡¨ä¸Šçš„æŸä¸ªèŠ‚ç‚¹å†…å­˜&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/*
 * å›æ”¶å¤§å—å†…å­˜é“¾è¡¨ä¸Šçš„æŸä¸ªèŠ‚ç‚¹å†…å­˜
 */
ngx_int_t
ngx_pfree(ngx_pool_t *pool, void *p)
{
    ngx_pool_large_t  *l;

    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) {
        if (p == l-&amp;gt;alloc) {
            ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0,
                           &amp;quot;free: %p&amp;quot;, l-&amp;gt;alloc);
            ngx_free(l-&amp;gt;alloc);
            l-&amp;gt;alloc = NULL;

            return NGX_OK;
        }
    }

    return NGX_DECLINED;
}
&lt;/code&gt;&lt;/pre&gt;
">Nginxæºç åˆ†æä¹‹--å†…å­˜æ± </a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://xly0713.github.io/post/gperftools-fen-xi-nginx/"" data-c="
          &lt;h2 id=&#34;å®‰è£…ä¾èµ–&#34;&gt;å®‰è£…ä¾èµ–&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;yum install libunwind-devel graphviz-devel ghostscript automake libtool -y&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç¼–è¯‘gpreftools&#34;&gt;ç¼–è¯‘gpreftools&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æºä»£ç ï¼šhttps://github.com/gperftools/gperftools/archive/gperftools-2.7.tar.gz&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘å®‰è£…
&lt;ul&gt;
&lt;li&gt;./autogen.sh&lt;/li&gt;
&lt;li&gt;./configure&lt;/li&gt;
&lt;li&gt;make &amp;amp;&amp;amp; make install&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯¼å‡ºLD_LIBRARY_PATH
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;export LD_LIBRARY_PATH=&amp;quot;$LD_LIBRARY_PATH:/usr/local/lib&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;nginxä½¿ç”¨tcmallocå’Œå¯ç”¨google_perftools_moduleæ¨¡å—&#34;&gt;nginxä½¿ç”¨tcmallocå’Œå¯ç”¨google_perftools_moduleæ¨¡å—&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--with-ld-opt=-ltcmalloc --with-google_perftools_module&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
">gperftoolsåˆ†æNginx</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://xly0713.github.io/post/tcp-xie-yi/"" data-c="
          &lt;p&gt;æœ¬æ–‡æ˜¯å¯¹tcpåè®®åŸºç¡€çŸ¥è¯†çš„æ•´ç†ä»‹ç»ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;tcpå»ºè¿-æ–­è¿&#34;&gt;tcpå»ºè¿ã€æ–­è¿&lt;/h2&gt;
&lt;h3 id=&#34;ç¤ºæ„å›¾&#34;&gt;ç¤ºæ„å›¾&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://xly0713.github.io/post-images/1586241639078.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é˜²æ­¢å¤±æ•ˆçš„è¿æ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ã€‚&lt;/li&gt;
&lt;li&gt;å…·ä½“æè¿°ï¼šå¦‚æœclientå‘é€çš„è¿æ¥è¯·æ±‚SYNåŒ…åœ¨ç½‘ç»œä¸­æ»ç•™äº†è¾ƒé•¿æ—¶é—´ï¼Œserveræœ€ç»ˆä»ä¼šæ”¶åˆ°å¹¶å‘å›è¿æ¥ç¡®è®¤SYN+ACKã€‚è€Œclientç­‰å¾…ä¸€ä¸ªè¶…æ—¶æ—¶é—´åï¼Œè®¤ä¸ºåˆšæ‰æ»ç•™çš„è¿æ¥è¯·æ±‚åŒ…ä¸¢å¤±äº†ï¼Œåˆ™ä¼šé‡æ–°å‘é€SYNåŒ…å‘èµ·è¿æ¥è¯·æ±‚ã€‚å¦‚æœä¸è¿›è¡Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆserveræ”¶åˆ°æ»ç•™çš„SYNåŒ…å°±æ‰“å¼€çš„è¿æ¥æ˜¯æ— æ•ˆçš„ï¼›å¦‚æœæœ‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆclientä¼šå¿½ç•¥serverå¯¹æ»ç•™çš„SYNåŒ…çš„å“åº”SYN+ACKï¼Œä¸å›å¤ACKåŒ…ï¼Œserveræ”¶ä¸åˆ°ç¬¬ä¸‰æ¬¡æ¡æ‰‹ACKåŒ…å°±ä¸ä¼šæ–°å»ºè¿æ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tcpé¢å‘è¿æ¥ä»€ä¹ˆå«ä¹‰&#34;&gt;tcpé¢å‘è¿æ¥ä»€ä¹ˆå«ä¹‰ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†åœ¨clientå’Œserveré—´ç»´æŠ¤è¿æ¥ï¼Œéœ€å»ºç«‹ä¸€å®šçš„æ•°æ®ç»“æ„æ¥ç»´æŠ¤åŒæ–¹çš„äº¤äº’çŠ¶æ€ï¼Œç”¨è¿™æ ·çš„æ•°æ®ç»“æ„æ¥ä¿è¯é¢å‘è¿æ¥çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸€ç«¯å‘é€FINåŒ…è¯·æ±‚é‡Šæ”¾è¿æ¥ï¼Œå¯¹ç«¯æ”¶åˆ°è¿™ä¸ªFINæŠ¥æ–‡åè¿›å…¥äº†&lt;code&gt;CLOSE_WAIT&lt;/code&gt;çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€ä¸‹ï¼Œä»ç„¶å¯ä»¥å‘å¯¹æ–¹å‘é€æœªå‘é€å®Œæ¯•çš„æ•°æ®ï¼Œæ•°æ®å‘é€å®Œæ¯•åä¹Ÿè¦å‘å¯¹ç«¯å‘é€FINæŠ¥æ–‡é‡Šæ”¾è¿æ¥ï¼Œå¿˜äº†å‘FINåŒ…(è°ƒç”¨close())ä¼šå¯¼è‡´bugã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒTCPæ˜¯å…¨åŒå·¥ä¼ è¾“ï¼Œä¸¤ç«¯éƒ½å¿…é¡»å‘é€FINåŒ…ï¼Œæ‰èƒ½å®Œå…¨æ–­å¼€è¿æ¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;time_waitçŠ¶æ€&#34;&gt;TIME_WAITçŠ¶æ€&lt;/h3&gt;
&lt;p&gt;ä¸»åŠ¨å‘é€FINåŒ…çš„ä¸€ç«¯ï¼Œåœ¨æ”¶åˆ°å¯¹ç«¯çš„FINæŠ¥æ–‡åè¿›å…¥&lt;code&gt;TIME_WAIT&lt;/code&gt;çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ä¸€èˆ¬è¦ä¿æŒä¸€ä¸ªè¾ƒé•¿çš„æ—¶é—´2MSLã€‚åŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¡®ä¿æœ€åä¸€ä¸ªåº”ç­”FINçš„æŠ¥æ–‡ACKèƒ½å¤Ÿåˆ°è¾¾ã€‚å› ä¸ºå¦‚æœå¯¹ç«¯æ²¡æœ‰æ”¶åˆ°ACKåº”ç­”ï¼Œåˆ™ä¼šé‡å‘FINåŒ…ã€‚&lt;/li&gt;
&lt;li&gt;è®©å½“å‰è¿æ¥åœ¨ç½‘ç»œä¸­å¯èƒ½çš„æ‰€æœ‰æŠ¥æ–‡è¾¾åˆ°ç”Ÿå­˜æœŸä¸Šé™åæ¶ˆå¤±ï¼Œä½¿å¾—ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸ä¼šæ”¶åˆ°æ—§çš„è¿æ¥çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä¸‰æ¬¡æ¡æ‰‹å†…æ ¸å®ç°åŸç†ç¤ºæ„å›¾&#34;&gt;ä¸‰æ¬¡æ¡æ‰‹å†…æ ¸å®ç°åŸç†ç¤ºæ„å›¾&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://xly0713.github.io/post-images/1586239797212.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;é˜Ÿåˆ—é•¿åº¦é…ç½®&#34;&gt;é˜Ÿåˆ—é•¿åº¦é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SYNé˜Ÿåˆ—é•¿åº¦é…ç½®: &lt;code&gt;net.ipv4.tcp_max_syn_backlog = 8192 #SYN_RCVDçŠ¶æ€è¿æ¥çš„æœ€å¤§ä¸ªæ•°&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;ACCEPTé˜Ÿåˆ—é•¿åº¦ï¼š
&lt;ul&gt;
&lt;li&gt;ç³»ç»Ÿå…¨å±€ï¼š &lt;code&gt;net.core.somaxconn = 262144 #ç³»ç»Ÿå…¨å±€ACCPETé˜Ÿåˆ—æœ€å¤§é•¿åº¦çš„é…ç½®&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;åº”ç”¨å±‚: socket API listenä¼ å‚æ§åˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;synæ”»å‡»&#34;&gt;SYNæ”»å‡»&lt;/h3&gt;
&lt;p&gt;æ”»å‡»è€…è¿…é€Ÿä¼ªé€ ä¸åŒIPåœ°å€çš„SYNæŠ¥æ–‡ï¼Œå¿«é€Ÿå æ»¡SYNé˜Ÿåˆ—ï¼Œä½¿å¾—æ­£å¸¸çš„SYNåŒ…æ— æ³•åŠ å…¥é˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åº”å¯¹synæ”»å‡»çš„å‚æ•°&#34;&gt;åº”å¯¹SYNæ”»å‡»çš„å‚æ•°&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;net.core.netdev_max_backlog = 262144 #æ¥æ”¶è‡ªç½‘å¡ã€ä½†æ˜¯æœªè¢«å†…æ ¸åè®®æ ˆå¤„ç†çš„IPæŠ¥æ–‡é˜Ÿåˆ—é•¿åº¦&lt;/code&gt;&lt;br&gt;
&lt;code&gt;net.ipv4.tcp_max_syn_backlog = 8192 #SYN_RCVDçŠ¶æ€(åŠ)è¿æ¥çš„æœ€å¤§ä¸ªæ•°&lt;/code&gt;&lt;br&gt;
&lt;code&gt;net.ipv4.tcp_abort_on_overflow = 1 #è®¾ç½®ä¸º1æ—¶è¡¨ç¤º: é˜Ÿåˆ—æ»¡åˆ™å“åº”RSTåŒ…ï¼Œä¸¢å¼ƒè¿æ¥&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;tcp_syncookies&#34;&gt;tcp_syncookies&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;net.ipv4.tcp_syncookies = 1 #å¯ç”¨tcp cookie, ä½¿å¾—SYNé˜Ÿåˆ—æ»¡ä»èƒ½å»ºç«‹è¿æ¥&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ§åˆ¶tcpä¸‰æ¬¡æ¡æ‰‹çš„å‚æ•°&#34;&gt;æ§åˆ¶TCPä¸‰æ¬¡æ¡æ‰‹çš„å‚æ•°&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;SYN_SENTçŠ¶æ€&lt;br&gt;
&lt;code&gt;net.ip4.tcp_syn_retries = 6 #ä¸»åŠ¨å»ºç«‹è¿æ¥ï¼Œå‘é€SYNçš„é‡è¯•æ¬¡æ•°&lt;/code&gt;&lt;br&gt;
&lt;code&gt;net.ipv4.ip_local_port_range = 32768 60999 #å»ºç«‹è¿æ¥æ—¶çš„æœ¬åœ°ç«¯å£å¯é€‰èŒƒå›´&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SYN_RCVDçŠ¶æ€&lt;br&gt;
&lt;code&gt;net.ipv4.tcp_max_syn_backlog = 8192 #SYN_RCVDçŠ¶æ€(åŠ)è¿æ¥çš„æœ€å¤§ä¸ªæ•°&lt;/code&gt;&lt;br&gt;
&lt;code&gt;net.ipv4.tcp_synack_retries = 3 #è¢«åŠ¨å»ºç«‹è¿æ¥æ—¶ï¼Œå‘é€SYN/ACKçš„é‡è¯•æ¬¡æ•°&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tfotcp-fast-open&#34;&gt;TFO(TCP Fast Open)&lt;/h2&gt;
&lt;p&gt;é…ç½®: &lt;code&gt;net.ipv4.tcp_fastopen&lt;/code&gt;ã€‚ï¼ˆ&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šå†…æ ¸ç‰ˆæœ¬è¦æ±‚åœ¨Linux 3.7ä»¥ä¸Šï¼‰&lt;br&gt;
å¯é€‰å€¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0: å…³é—­(é»˜è®¤)&lt;/li&gt;
&lt;li&gt;1: ä½œä¸ºå®¢æˆ·ç«¯æ—¶å¯ä»¥ä½¿ç”¨TFO&lt;/li&gt;
&lt;li&gt;2: ä½œä¸ºæœåŠ¡ç«¯æ—¶å¯ä»¥ä½¿ç”¨TFO&lt;/li&gt;
&lt;li&gt;3: éƒ½å¯ä»¥ä½¿ç”¨TFOï¼Œæ— è®ºæ˜¯ä½œä¸ºæœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¤ºæ„å›¾-2&#34;&gt;ç¤ºæ„å›¾&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://xly0713.github.io/post-images/1586580242109.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">TCPåè®®åŸºç¡€</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://xly0713.github.io/post/dns/"" data-c="
          &lt;p&gt;æœ¬æ–‡æ˜¯å¯¹DNSåè®®çš„ç®€å•æ•´ç†ä»‹ç»ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;dnsæ˜¯ä»€ä¹ˆ&#34;&gt;DNSæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;DNSæ˜¯äº’è”ç½‘ä¸–ç•Œçš„åœ°å€è–„ï¼Œç±»ä¼¼äºç”µè¯æœ¬ï¼Œä¸»è¦æä¾›å°†åŸŸåæ˜ å°„åˆ°IPåœ°å€çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;dnsçš„æ ‘çŠ¶å±‚æ¬¡ç»“æ„&#34;&gt;DNSçš„æ ‘çŠ¶å±‚æ¬¡ç»“æ„&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€å±‚: æ ¹DNSæœåŠ¡å™¨ï¼Œè´Ÿè´£è¿”å›é¡¶çº§DNS(TLD)æœåŠ¡å™¨çš„IPåœ°å€ã€‚ç›®å‰å…¨ä¸–ç•Œæœ‰13å°æœåŠ¡èŠ‚ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒå±‚: TLDæœåŠ¡å™¨ï¼Œè´Ÿè´£è¿”å›æƒå¨DNSæœåŠ¡å™¨çš„IPåœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰å±‚: æƒå¨DNSæœåŠ¡å™¨ï¼Œè´Ÿè´£è¿”å›ç›¸åº”ä¸»æœºæˆ–åŸŸåçš„IPåœ°å€ã€‚&lt;br&gt;
&lt;img src=&#34;https://xly0713.github.io/post-images/1586003718190.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;dnsçš„è§£ææµç¨‹&#34;&gt;DNSçš„è§£ææµç¨‹&lt;/h2&gt;
&lt;p&gt;åœ¨æœªå‘½ä¸­ç¼“å­˜çš„æƒ…å†µä¸‹ï¼ŒDNSå®ŒæˆåŸŸåçš„è§£æéœ€è¦ç»è¿‡å¦‚ä¸‹æ­¥éª¤:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥â€œexample.comâ€, æŸ¥è¯¢ç”±æœ¬åœ°DNSæœåŠ¡(&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;)è§£æå™¨æ¥æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;æŸ¥è¯¢&lt;strong&gt;æ ¹DNSåŸŸåæœåŠ¡å™¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ¹DNSæœåŠ¡å™¨&lt;/strong&gt;ä½¿ç”¨&lt;strong&gt;é¡¶çº§DNS(TLD)æœåŠ¡å™¨&lt;/strong&gt;(ä¾‹å¦‚.comæˆ–.net)çš„åœ°å€å“åº”ç»™&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;ã€‚å¦‚ï¼šâ€œexample.comâ€ï¼Œåˆ™è¿”å›.com TLDçš„IPåœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;å‘.com&lt;strong&gt;é¡¶çº§DNS(TLD)æœåŠ¡å™¨&lt;/strong&gt;å‘å‡ºè¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡¶çº§DNS(TLD)æœåŠ¡å™¨&lt;/strong&gt;å“åº”&lt;strong&gt;æƒå¨DNSæœåŠ¡å™¨&lt;/strong&gt;çš„IPåœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;å‘&lt;strong&gt;æƒå¨DNSæœåŠ¡å™¨&lt;/strong&gt;ç¿»å‡ºè¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒå¨DNSæœåŠ¡å™¨&lt;/strong&gt;å“åº”example.comçš„IPåœ°å€ç»™&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€’å½’DNSæœåŠ¡å™¨&lt;/strong&gt;å°†example.comçš„IPåœ°å€å“åº”ç»™æµè§ˆå™¨ã€‚ï¼ˆ&lt;em&gt;DNSè§£æå®Œæˆ&lt;/em&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;æµè§ˆå™¨å‘example.comçš„IPåœ°å€å‘å‡ºHTTPè¯·æ±‚...&lt;br&gt;
&lt;img src=&#34;https://xly0713.github.io/post-images/1586005095657.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;dnsç¼“å­˜&#34;&gt;DNSç¼“å­˜&lt;/h2&gt;
&lt;p&gt;åœ¨æœªå‘½ä¸­ç¼“å­˜çš„æƒ…å½¢ä¸‹ï¼ŒDNSè§£æçš„æµç¨‹æ˜¯å¤æ‚ä¸”è€—æ—¶çš„ã€‚DNSæ•°æ®å¯ä»¥è¢«ç¼“å­˜åœ¨å¤šä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®å¯ä»¥åœ¨ä¸€æ®µæ—¶é—´å†…(è®°å½•ç”Ÿå­˜æ—¶é—´TTL)ç¼“å­˜DNSæ•°æ®è®°å½•:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æµè§ˆå™¨DNSç¼“å­˜&lt;/li&gt;
&lt;li&gt;æ“ä½œç³»ç»Ÿçº§DNSç¼“å­˜&lt;/li&gt;
&lt;li&gt;é€’å½’DNSæœåŠ¡å™¨çº§åˆ«ç¼“å­˜ã€‚&lt;em&gt;å¦‚æœåŸŸåç¼“å­˜æœªå‘½ä¸­ï¼Œä½†æ˜¯å‘½ä¸­äº†è¯¥åŸŸåçš„NSè®°å½•ï¼Œåˆ™è·³è¿‡è¯·æ±‚æ ¹å’ŒTLDæœåŠ¡å™¨ï¼›å¦‚æœæ²¡æœ‰NSè®°å½•ï¼Œä½†æ˜¯å‘½ä¸­äº†TLDçš„è®°å½•ï¼Œåˆ™è·³è¿‡è¯·æ±‚æ ¹æœåŠ¡å™¨ï¼›å¦‚æœæ²¡æœ‰å‘½ä¸­TLDçš„è®°å½•ï¼Œåˆ™è¦å®Œæ•´èµ°å®Œè¿­ä»£è®¿é—®æ ¹DNSæœåŠ¡å™¨åˆ°æƒå¨æœåŠ¡å™¨è¿™ä¸€å…¨æµç¨‹äº†ã€‚&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;dnsè®°å½•ç±»å‹&#34;&gt;DNSè®°å½•ç±»å‹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¸¸è§ç±»å‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;Aè®°å½•: åŸŸåæ˜ å°„çš„IPv4åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;CNAMEè®°å½•ï¼šåŸŸååˆ«åæ˜ å°„ï¼Œå°†åŸŸåæŒ‡å‘å¦å¤–ä¸€ä¸ªåŸŸåã€‚&lt;/li&gt;
&lt;li&gt;NSè®°å½•ï¼šåŸŸåæ˜ å°„çš„æƒå¨æœåŠ¡å™¨è®°å½•ã€‚&lt;/li&gt;
&lt;li&gt;AAAAè®°å½•ï¼šåŸŸåæ˜ å°„çš„IPv6åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;MXè®°å½•ï¼šåŸŸåæ˜ å°„çš„é‚®ç®±æœåŠ¡å™¨åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;TXTè®°å½•ï¼šå…è®¸ç®¡ç†å‘˜åœ¨è®°å½•ä¸­å­˜å‚¨æ–‡æœ¬ã€‚&lt;/li&gt;
&lt;li&gt;SOAè®°å½•ï¼šå­˜å‚¨æœ‰å…³åŸŸçš„ç®¡ç†å‘˜ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;SRVè®°å½•ï¼šæŒ‡å®šç‰¹å®šæœåŠ¡çš„ç«¯å£ã€‚&lt;/li&gt;
&lt;li&gt;PTRè®°å½•ï¼šåœ¨åå‘æŸ¥è¯¢ä¸­æä¾›åŸŸåã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;dnsåè®®æŠ¥æ–‡æ ¼å¼&#34;&gt;DNSåè®®æŠ¥æ–‡æ ¼å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;https://jocent.me/2017/06/18/dns-protocol-principle.html&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;èƒ¶æ°´è®°å½•glue-record&#34;&gt;èƒ¶æ°´è®°å½•(Glue record)&lt;/h2&gt;
&lt;p&gt;å½“ç»™&lt;strong&gt;åŸŸåA&lt;/strong&gt;é…ç½®NSè®°å½•æ—¶ï¼Œå¦‚æœNSè®°å½•ä¸º&lt;strong&gt;åŸŸåA&lt;/strong&gt;çš„å­åŸŸåï¼Œåˆ™å¿…é¡»é…ç½®NSè®°å½•çš„Aè®°å½•ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šå¸¸éœ€è¦åœ¨åŸŸåæä¾›å•†å“ªé‡Œç”³è¯·ä¸¤ä¸ªåŸŸåï¼Œè€Œä¸å»ºè®®é‡‡ç”¨èƒ¶æ°´è®°å½•æ–¹å¼ã€‚&lt;/li&gt;
&lt;li&gt;å‚è€ƒé“¾æ¥ï¼šhttps://www.jianshu.com/p/7d69ec2976c7&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;dnsä¼˜ç§€çš„goå¼€æºé¡¹ç›®&#34;&gt;DNSä¼˜ç§€çš„goå¼€æºé¡¹ç›®&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;https://github.com/miekg/dns&lt;/li&gt;
&lt;li&gt;https://github.com/abh/geodns ï¼ˆä½¿ç”¨miekg/dnsï¼‰&lt;/li&gt;
&lt;/ul&gt;
">DNSåè®®åŸºç¡€</a>
      </div>
      
      <div class="item">
        <a class="result-title" href="https://xly0713.github.io/post/about/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å…³äºæœ¬ç«™&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/h2&gt;
&lt;p&gt;æœ¬ç«™ä¸»è¦ç”¨æ¥è®°å½•ä¸€äº›æŠ€æœ¯ï¼Œå¸®åŠ©è‡ªå·±æ•´ç†é›¶ç¢çš„çŸ¥è¯†ï¼Œå¸Œæœ›å¯¹ä»–äººæœ‰æ‰€å¸®åŠ©ã€‚æ¬¢è¿&lt;a href=&#34;/atom.xml&#34;&gt;RSS&lt;/a&gt;è®¢é˜…æœ¬ç«™ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åšä¸»æ˜¯è°&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/h2&gt;
&lt;p&gt;åšä¸»æ˜¯ä¸€ååå°ç ”å‘æ”»åŸç‹®ï¼Œå…³æ³¨äº‘è®¡ç®—ç›¸å…³é¢†åŸŸï¼Œç›®å‰ä¸“æ³¨äºCDNæŠ€æœ¯å’Œç›´æ’­æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è”ç³»æˆ‘å‘€&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é‚®ä»¶: xly880713@gmail.com&lt;/li&gt;
&lt;/ul&gt;
">å…³äº</a>
      </div>
      
    </div>
  </div>
</div>
<script>
  // var escape = "[{&#34;content&#34;:&#34;&lt;p&gt;Nginxä½œä¸ºé«˜æ€§èƒ½çš„webæœåŠ¡å™¨ï¼Œå®ƒæ˜¯å¦‚ä½•ç®¡ç†å†…å­˜çš„å‘¢ï¼Ÿ&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;å†…å­˜æ± çš„ä¼˜ç‚¹\&#34;&gt;å†…å­˜æ± çš„ä¼˜ç‚¹&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;poolåŒ–å¤„ç†ï¼Œé¿å…å¤šæ¬¡å‘ç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œå‡å°‘ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢ï¼Œæé«˜å†…å­˜åˆ†é…æ•ˆç‡;&lt;/li&gt;\n&lt;li&gt;å†…å­˜ç»Ÿä¸€åˆ†é…å’Œå›æ”¶ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼›&lt;/li&gt;\n&lt;li&gt;æ•´å—åˆ†é…ï¼Œé¿å…å†…å­˜è¿‡äºç¢ç‰‡åŒ–;&lt;/li&gt;\n&lt;li&gt;å†…å­˜å¯¹é½å¤„ç†ï¼Œå‡å°‘CPUè¯»å–å†…å­˜æ¬¡æ•°ï¼Œæé«˜å¯»å€æ•ˆç‡ï¼›&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;å†…å­˜æ± ç›¸å…³çš„æ•°æ®ç»“æ„\&#34;&gt;å†…å­˜æ± ç›¸å…³çš„æ•°æ®ç»“æ„&lt;/h2&gt;\n&lt;h3 id=\&#34;ç»“æ„ä½“ç¤ºæ„å›¾\&#34;&gt;ç»“æ„ä½“ç¤ºæ„å›¾&lt;/h3&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://xly0713.github.io/post-images/1587183416580.jpg\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h3 id=\&#34;æ•°æ®ç»“æ„å®šä¹‰\&#34;&gt;æ•°æ®ç»“æ„å®šä¹‰&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;typedef struct ngx_pool_s            ngx_pool_t;\ntypedef struct ngx_pool_large_s  ngx_pool_large_t;\n\nstruct ngx_pool_s { //å†…å­˜æ± å¤´éƒ¨ç»“æ„\n    ngx_pool_data_t       d;        //å†…å­˜æ± çš„æ•°æ®åŒºï¼Œå³çœŸæ­£åˆ†é…å†…å­˜çš„åŒºåŸŸ\n    size_t                max;      //æ¯æ¬¡å¯åˆ†é…æœ€å¤§å†…å­˜ï¼Œç”¨äºåˆ¤å®šæ˜¯èµ°å¤§å†…å­˜åˆ†é…è¿˜æ˜¯å°å†…å­˜åˆ†é…é€»è¾‘\n    ngx_pool_t           *current;  //æŒ‡å‘å½“å‰å†…å­˜æ± å°å—å†…å­˜å¯ç”¨çš„é¦–ä¸ªèŠ‚ç‚¹\n    ngx_chain_t          *chain;    //ç¼“å†²åŒºé“¾è¡¨\n    ngx_pool_large_t     *large;    //å†…å­˜å—å¤§äºmaxå†…å­˜å—çš„é“¾è¡¨\n    ngx_pool_cleanup_t   *cleanup;  //é”€æ¯å†…å­˜æ± å›è°ƒå‡½æ•°\n    ngx_log_t            *log;      //é”™è¯¯æ—¥å¿—æŒ‡é’ˆ\n};\n\ntypedef struct {\n    u_char               *last;     //å½“å‰å†…å­˜å—å·²ä½¿ç”¨åˆ°æ­¤å¤„ï¼Œä¸‹ä¸€æ¬¡ä½¿ç”¨ä»æ­¤å¤„å¼€å§‹\n    u_char               *end;      //å†…å­˜å—ç»“æŸä½ç½®\n    ngx_pool_t           *next;     //å†…å­˜æ± æœ‰å¾ˆå¤šå†…å­˜å—ï¼Œé€šè¿‡nextæŒ‡é’ˆç»„æˆé“¾è¡¨\n    ngx_uint_t            failed;   //å†…å­˜å—åˆ†é…å¤±è´¥æ¬¡æ•°\n} ngx_pool_data_t; //å°å†…å­˜å—(é“¾è¡¨)\n\n//å¤§å†…å­˜å—(é“¾è¡¨)\nstruct ngx_pool_large_s {\n    ngx_pool_large_t     *next;  //ä¸‹ä¸€æ•°æ®å—åœ°å€\n    void                 *alloc; //å½“å‰æ•°æ®å—åœ°å€\n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&#34;å†…å­˜æ± ä¸»è¦å‡½æ•°\&#34;&gt;å†…å­˜æ± ä¸»è¦å‡½æ•°&lt;/h2&gt;\n&lt;h3 id=\&#34;æ–°å»ºå†…å­˜æ± \&#34;&gt;æ–°å»ºå†…å­˜æ± &lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * æ–°å»ºä¸€ä¸ªå†…å­˜æ± \n */\nngx_pool_t *\nngx_create_pool(size_t size, ngx_log_t *log)\n{\n    ngx_pool_t  *p;\n\n    //è°ƒç”¨ç³»ç»Ÿå†…å­˜åˆ†é…å‡½æ•°ï¼Œåˆ†é…ä¸€å—å †å†…å­˜ï¼Œä¸”åšå¯¹é½å¤„ç†\n    p = ngx_memalign(NGX_POOL_ALIGNMENT, size, log);\n    if (p == NULL) {\n        return NULL;\n    }\n\n    p-&amp;gt;d.last = (u_char *) p + sizeof(ngx_pool_t);\n    p-&amp;gt;d.end = (u_char *) p + size;\n    p-&amp;gt;d.next = NULL;\n    p-&amp;gt;d.failed = 0;\n\n    size = size - sizeof(ngx_pool_t);\n    //maxæœ€å¤§ä¸ºpagesize-1(æ¯”å¦‚:x86æ—¶ä¸º4095), å³ï¼šæ— è®ºå°å—å†…å­˜ç©ºé—´æ˜¯å¦è¶³å¤Ÿï¼Œè¶…è¿‡pagesize-1å¤§å°çš„å†…å­˜å‡èµ°largeå—åˆ†é…\n    p-&amp;gt;max = (size &amp;lt; NGX_MAX_ALLOC_FROM_POOL) ? size : NGX_MAX_ALLOC_FROM_POOL;\n\n    p-&amp;gt;current = p;\n    p-&amp;gt;chain = NULL;\n    p-&amp;gt;large = NULL;\n    p-&amp;gt;cleanup = NULL;\n    p-&amp;gt;log = log;\n\n    return p;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;ä»å†…å­˜æ± ç”³è¯·å†…å­˜\&#34;&gt;ä»å†…å­˜æ± ç”³è¯·å†…å­˜&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;å…ˆå¯¹é½å†åˆ†é…å†…å­˜&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * ä»å†…å­˜æ± ä¸­ç”³è¯·ä¸€å—å†…å­˜\n * ï¼ˆ1ï¼‰å¦‚æœç”³è¯·çš„å†…å­˜å°äºå®šä¹‰çš„maxï¼Œåˆ™ä»å†…å­˜æ± ä¸­åˆ†é…å†…å­˜ï¼Œéœ€å…ˆå¯¹é½å†åˆ†é…\n * ï¼ˆ2ï¼‰å¦åˆ™åˆ†é…å¤§å—å†…å­˜æŒ‚è½½åˆ°largeæŒ‡é’ˆä¸Š\n */\nvoid *\nngx_palloc(ngx_pool_t *pool, size_t size)\n{\n#if !(NGX_DEBUG_PALLOC)\n    if (size &amp;lt;= pool-&amp;gt;max) {\n        return ngx_palloc_small(pool, size, 1); //å°å—å†…å­˜(å…ˆå¯¹é½)\n    }\n#endif\n\n    return ngx_palloc_large(pool, size);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;å…ˆå¯¹é½å†åˆ†é…å†…å­˜, å¹¶å¡«å……0&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * ä»å†…å­˜æ± ä¸­ç”³è¯·å†…å­˜ï¼Œå¹¶å¡«å……0\n */\nvoid *\nngx_pcalloc(ngx_pool_t *pool, size_t size)\n{\n    void *p;\n\n    p = ngx_palloc(pool, size);\n    if (p) {\n        ngx_memzero(p, size);\n    }\n\n    return p;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;ä¸ç”¨å¯¹é½åˆ†é…å†…å­˜&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * ä»å†…å­˜æ± ä¸­ç”³è¯·ä¸€å—å†…å­˜ ï¼ˆå°å—å†…å­˜æ— éœ€å…ˆå¯¹é½ï¼‰\n */\nvoid *\nngx_pnalloc(ngx_pool_t *pool, size_t size)\n{\n#if !(NGX_DEBUG_PALLOC)\n    if (size &amp;lt;= pool-&amp;gt;max) {\n        return ngx_palloc_small(pool, size, 0); //å°å—å†…å­˜ï¼ˆæ— éœ€å…ˆå¯¹é½ï¼‰\n    }\n#endif\n\n    return ngx_palloc_large(pool, size);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;ä»å†…å­˜æ± ç”³è¯·å†…å­˜å°å—å†…å­˜\&#34;&gt;ä»å†…å­˜æ± ç”³è¯·å†…å­˜å°å—å†…å­˜&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * åˆ†é…å°å—å†…å­˜\n * 1. å¾ªç¯éå†å†…å­˜å—ngx_pool_data_té“¾è¡¨\n * 2. å¦‚æœå½“å‰å†…å­˜å—å‰©ä½™å¤§å°æ»¡è¶³ç”³è¯·çš„å†…å­˜å¤§å°ï¼Œåˆ™ç§»åŠ¨ç›¸åº”æŒ‡é’ˆï¼Œè¿”å›åˆ†é…çš„å†…å­˜æŒ‡é’ˆ\n * 3. å¦åˆ™ï¼Œç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå†…å­˜å—\n * 4. å¦‚æœæ‰€æœ‰å†…å­˜å—éƒ½æ²¡èƒ½æ»¡è¶³ç”³è¯·çš„å†…å­˜å¤§å°ï¼Œåˆ™é‡æ–°ç”³è¯·ä¸€å—å†…å­˜å—æŒ‚è½½åˆ°é“¾è¡¨ä¸Šï¼Œå¹¶è¿”å›åˆ†é…çš„å†…å­˜åœ°å€\n */\nstatic ngx_inline void *\nngx_palloc_small(ngx_pool_t *pool, size_t size, ngx_uint_t align)\n{\n    u_char      *m;\n    ngx_pool_t  *p;\n\n    p = pool-&amp;gt;current;\n\n    do {\n        m = p-&amp;gt;d.last; //æœ€åä½¿ç”¨ä½ç½®\n\n        if (align) {\n            m = ngx_align_ptr(m, NGX_ALIGNMENT); //å…ˆå†…å­˜å¯¹é½, å‡å°‘CPUè¯»å–å†…å­˜æ¬¡æ•°\n        }\n\n        if ((size_t) (p-&amp;gt;d.end - m) &amp;gt;= size) { //å½“å‰å†…å­˜å—å‰©ä½™ç©ºé—´è¶³å¤Ÿ\n            p-&amp;gt;d.last = m + size; //æœ€åä½¿ç”¨ä½ç½®æ›´æ–°ï¼Œå‰©ä½™ç©ºé—´å˜å°\n\n            return m;\n        }\n\n        p = p-&amp;gt;d.next;\n\n    } while (p);\n\n    //ç°æœ‰å°å—å†…å­˜å‡æ— æ³•åˆ†é…ï¼Œåˆ™æ–°å»ºå†…å­˜å—åå†åˆ†é…\n    return ngx_palloc_block(pool, size);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;æ–°å»ºå°å†…å­˜å—å†åˆ†é…\&#34;&gt;æ–°å»ºå°å†…å­˜å—å†åˆ†é…&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * å†æ¬¡ç”³è¯·å°å—å†…å­˜ï¼Œå¹¶æŒ‚è½½åˆ°å°å—å†…å­˜é“¾è¡¨ä¸Šï¼Œå¹¶è¿”å›å½“æ¬¡ç”³è¯·çš„å†…å­˜æŒ‡é’ˆ\n*/\nstatic void *\nngx_palloc_block(ngx_pool_t *pool, size_t size)\n{\n    u_char      *m;\n    size_t       psize;\n    ngx_pool_t  *p, *new;\n\n    psize = (size_t) (pool-&amp;gt;d.end - (u_char *) pool);\n\n    m = ngx_memalign(NGX_POOL_ALIGNMENT, psize, pool-&amp;gt;log);\n    if (m == NULL) {\n        return NULL;\n    }\n\n    new = (ngx_pool_t *) m;\n\n    new-&amp;gt;d.end = m + psize;\n    new-&amp;gt;d.next = NULL;\n    new-&amp;gt;d.failed = 0;\n\n    m += sizeof(ngx_pool_data_t);\n    m = ngx_align_ptr(m, NGX_ALIGNMENT);\n    new-&amp;gt;d.last = m + size;\n\n    for (p = pool-&amp;gt;current; p-&amp;gt;d.next; p = p-&amp;gt;d.next) {\n        //è°ƒæ•´å„ä¸ªå†…å­˜å—åˆ†é…å¤±è´¥æ¬¡æ•°ï¼Œå¦‚æœå¤±è´¥æ¬¡æ•°å¤§äº4ï¼Œåˆ™æ­¤å—å†…å­˜èŠ‚ç‚¹ä¸å†ä½¿ç”¨\n        if (p-&amp;gt;d.failed++ &amp;gt; 4) {\n            pool-&amp;gt;current = p-&amp;gt;d.next;\n        }\n    }\n\n    p-&amp;gt;d.next = new;\n\n    return m;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;åˆ†é…å¤§å†…å­˜\&#34;&gt;åˆ†é…å¤§å†…å­˜&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * åˆ†é…å¤§å†…å­˜å—\n */\nstatic void *\nngx_palloc_large(ngx_pool_t *pool, size_t size)\n{\n    void              *p;\n    ngx_uint_t         n;\n    ngx_pool_large_t  *large;\n\n    p = ngx_alloc(size, pool-&amp;gt;log); //å‘ç³»ç»Ÿç”³è¯·sizeå¤§å°å †å†…å­˜\n    if (p == NULL) {\n        return NULL;\n    }\n\n    n = 0;\n\n    //æŸ¥æ‰¾ä¸€ä¸ªç©ºçš„largeåŒºï¼Œå¦‚æœæœ‰ï¼Œåˆ™å°†åˆ†é…çš„ç©ºé—´päº¤ç”±å®ƒç®¡ç†ï¼ˆæœ€å¤š3æ¬¡ï¼‰\n    for (large = pool-&amp;gt;large; large; large = large-&amp;gt;next) {\n        if (large-&amp;gt;alloc == NULL) { //ngx_pfreeå‡½æ•°ä¼šäº§ç”Ÿç©ºçš„largeåŒº\n            large-&amp;gt;alloc = p;\n            return p;\n        }\n\n        if (n++ &amp;gt; 3) { //è¶…è¿‡ä¸€å®šæ¬¡æ•°ï¼Œæ”¾å¼ƒæŸ¥æ‰¾ç©ºçš„largeåŒº\n            break;\n        }\n    }\n\n    //åˆ›å»ºä¸€ä¸ªæ–°çš„largeèŠ‚ç‚¹\n    large = ngx_palloc_small(pool, sizeof(ngx_pool_large_t), 1);\n    if (large == NULL) {\n        ngx_free(p);\n        return NULL;\n    }\n\n    //æ–°åˆ†é…çš„ç©ºé—´päº¤ç”±æ–°å»ºçš„largeèŠ‚ç‚¹ç®¡ç†ï¼Œå¹¶ä¸”æ’å…¥åˆ°largeé“¾è¡¨å¤´éƒ¨\n    large-&amp;gt;alloc = p;\n    large-&amp;gt;next = pool-&amp;gt;large;\n    pool-&amp;gt;large = large;\n\n    return p;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;é”€æ¯å†…å­˜æ± \&#34;&gt;é”€æ¯å†…å­˜æ± &lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * é”€æ¯å†…å­˜æ± \n */\nvoid\nngx_destroy_pool(ngx_pool_t *pool)\n{\n    ngx_pool_t          *p, *n;\n    ngx_pool_large_t    *l;\n    ngx_pool_cleanup_t  *c;\n\n    for (c = pool-&amp;gt;cleanup; c; c = c-&amp;gt;next) {\n        if (c-&amp;gt;handler) {\n            ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0,\n                           &amp;quot;run cleanup: %p&amp;quot;, c);\n            c-&amp;gt;handler(c-&amp;gt;data);\n        }\n    }\n\n#if (NGX_DEBUG)\n\n    /*\n     * we could allocate the pool-&amp;gt;log from this pool\n     * so we cannot use this log while free()ing the pool\n     */\n\n    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) {\n        ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0, &amp;quot;free: %p&amp;quot;, l-&amp;gt;alloc);\n    }\n\n    for (p = pool, n = pool-&amp;gt;d.next; /* void */; p = n, n = n-&amp;gt;d.next) {\n        ngx_log_debug2(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0,\n                       &amp;quot;free: %p, unused: %uz&amp;quot;, p, p-&amp;gt;d.end - p-&amp;gt;d.last);\n\n        if (n == NULL) {\n            break;\n        }\n    }\n\n#endif\n\n    //é‡Šæ”¾å¤§å†…å­˜å—ï¼ˆé“¾è¡¨ï¼‰\n    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) {\n        if (l-&amp;gt;alloc) {\n            ngx_free(l-&amp;gt;alloc);\n        }\n    }\n\n    //é‡Šæ”¾å°å†…å­˜å— (é“¾è¡¨)\n    for (p = pool, n = pool-&amp;gt;d.next; /* void */; p = n, n = n-&amp;gt;d.next) {\n        ngx_free(p);\n\n        if (n == NULL) {\n            break;\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;é‡ç½®å†…å­˜æ± \&#34;&gt;é‡ç½®å†…å­˜æ± &lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * é‡ç½®å†…å­˜æ± \n * 1. é‡Šæ”¾å¤§å—å†…å­˜\n * 2. é‡ç½®å¯å¼€å§‹åˆ†é…ä½ç½®æŒ‡é’ˆã€åˆ†é…å¤±è´¥æ¬¡æ•°ä¸º0ã€å¯ç”¨å°å†…å­˜å—currentæŒ‡é’ˆæŒ‡å‘é¦–ä¸ªå†…å­˜å—\n */\nvoid\nngx_reset_pool(ngx_pool_t *pool)\n{\n    ngx_pool_t        *p;\n    ngx_pool_large_t  *l;\n\n    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) { //éå†å¤§å—å†…å­˜é“¾è¡¨ï¼Œé‡Šæ”¾å†…å­˜\n        if (l-&amp;gt;alloc) {\n            ngx_free(l-&amp;gt;alloc);\n        }\n    }\n\n    for (p = pool; p; p = p-&amp;gt;d.next) {\n        p-&amp;gt;d.last = (u_char *) p + sizeof(ngx_pool_t); //æ¢å¤è‡³åˆå§‹ä¸ºä½ç½®\n        p-&amp;gt;d.failed = 0; //åˆ†é…å¤±è´¥æ¬¡æ•°é‡ç½®ä¸º0\n    }\n\n    pool-&amp;gt;current = pool; //currentæŒ‡å‘é¦–ä¸ªå†…å­˜å—\n    pool-&amp;gt;chain = NULL;\n    pool-&amp;gt;large = NULL;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&#34;å›æ”¶å¤§å—å†…å­˜é“¾è¡¨ä¸Šçš„æŸä¸ªèŠ‚ç‚¹å†…å­˜\&#34;&gt;å›æ”¶å¤§å—å†…å­˜é“¾è¡¨ä¸Šçš„æŸä¸ªèŠ‚ç‚¹å†…å­˜&lt;/h3&gt;\n&lt;pre&gt;&lt;code&gt;/*\n * å›æ”¶å¤§å—å†…å­˜é“¾è¡¨ä¸Šçš„æŸä¸ªèŠ‚ç‚¹å†…å­˜\n */\nngx_int_t\nngx_pfree(ngx_pool_t *pool, void *p)\n{\n    ngx_pool_large_t  *l;\n\n    for (l = pool-&amp;gt;large; l; l = l-&amp;gt;next) {\n        if (p == l-&amp;gt;alloc) {\n            ngx_log_debug1(NGX_LOG_DEBUG_ALLOC, pool-&amp;gt;log, 0,\n                           &amp;quot;free: %p&amp;quot;, l-&amp;gt;alloc);\n            ngx_free(l-&amp;gt;alloc);\n            l-&amp;gt;alloc = NULL;\n\n            return NGX_OK;\n        }\n    }\n\n    return NGX_DECLINED;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&#34;,&#34;fileName&#34;:&#34;nginx-yuan-ma-xue-xi&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;Nginxä½œä¸ºé«˜æ€§èƒ½çš„webæœåŠ¡å™¨ï¼Œå®ƒæ˜¯å¦‚ä½•ç®¡ç†å†…å­˜çš„å‘¢ï¼Ÿ&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;Nginxæºç åˆ†æä¹‹--å†…å­˜æ± &#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Nginx&#34;,&#34;slug&#34;:&#34;ZUZBgmRmp&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://xly0713.github.io/tag/ZUZBgmRmp/&#34;},{&#34;name&#34;:&#34;æºç åˆ†æ&#34;,&#34;slug&#34;:&#34;1FH1KPhrG&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://xly0713.github.io/tag/1FH1KPhrG/&#34;}],&#34;date&#34;:&#34;2020-04-11 22:09:35&#34;,&#34;dateFormat&#34;:&#34;2020-04-11&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://xly0713.github.io/post/nginx-yuan-ma-xue-xi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;9 min read&#34;,&#34;time&#34;:482000,&#34;words&#34;:1761,&#34;minutes&#34;:9},&#34;description&#34;:&#34;Nginxä½œä¸ºé«˜æ€§èƒ½çš„webæœåŠ¡å™¨ï¼Œå®ƒæ˜¯å¦‚ä½•ç®¡ç†å†…å­˜çš„å‘¢ï¼Ÿ\n\nå†…å­˜æ± çš„ä¼˜ç‚¹\n\npoolåŒ–å¤„ç†ï¼Œé¿å…å¤šæ¬¡å‘ç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œå‡å°‘ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢ï¼Œæé«˜å†…å­˜åˆ†é…æ•ˆç‡;\nå†…å­˜ç»Ÿä¸€åˆ†é…å’Œå›æ”¶ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼›\næ•´å—åˆ†é…ï¼Œé¿å…å†…å­˜è¿‡äºç¢ç‰‡åŒ–;\nå†…å­˜å¯¹é½å¤„...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%86%85%E5%AD%98%E6%B1%A0%E7%9A%84%E4%BC%98%E7%82%B9\&#34;&gt;å†…å­˜æ± çš„ä¼˜ç‚¹&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%86%85%E5%AD%98%E6%B1%A0%E7%9B%B8%E5%85%B3%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84\&#34;&gt;å†…å­˜æ± ç›¸å…³çš„æ•°æ®ç»“æ„&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%BB%93%E6%9E%84%E4%BD%93%E7%A4%BA%E6%84%8F%E5%9B%BE\&#34;&gt;ç»“æ„ä½“ç¤ºæ„å›¾&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9A%E4%B9%89\&#34;&gt;æ•°æ®ç»“æ„å®šä¹‰&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%86%85%E5%AD%98%E6%B1%A0%E4%B8%BB%E8%A6%81%E5%87%BD%E6%95%B0\&#34;&gt;å†…å­˜æ± ä¸»è¦å‡½æ•°&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%96%B0%E5%BB%BA%E5%86%85%E5%AD%98%E6%B1%A0\&#34;&gt;æ–°å»ºå†…å­˜æ± &lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BB%8E%E5%86%85%E5%AD%98%E6%B1%A0%E7%94%B3%E8%AF%B7%E5%86%85%E5%AD%98\&#34;&gt;ä»å†…å­˜æ± ç”³è¯·å†…å­˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%BB%8E%E5%86%85%E5%AD%98%E6%B1%A0%E7%94%B3%E8%AF%B7%E5%86%85%E5%AD%98%E5%B0%8F%E5%9D%97%E5%86%85%E5%AD%98\&#34;&gt;ä»å†…å­˜æ± ç”³è¯·å†…å­˜å°å—å†…å­˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%96%B0%E5%BB%BA%E5%B0%8F%E5%86%85%E5%AD%98%E5%9D%97%E5%86%8D%E5%88%86%E9%85%8D\&#34;&gt;æ–°å»ºå°å†…å­˜å—å†åˆ†é…&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%88%86%E9%85%8D%E5%A4%A7%E5%86%85%E5%AD%98\&#34;&gt;åˆ†é…å¤§å†…å­˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%94%80%E6%AF%81%E5%86%85%E5%AD%98%E6%B1%A0\&#34;&gt;é”€æ¯å†…å­˜æ± &lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%87%8D%E7%BD%AE%E5%86%85%E5%AD%98%E6%B1%A0\&#34;&gt;é‡ç½®å†…å­˜æ± &lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%9B%9E%E6%94%B6%E5%A4%A7%E5%9D%97%E5%86%85%E5%AD%98%E9%93%BE%E8%A1%A8%E4%B8%8A%E7%9A%84%E6%9F%90%E4%B8%AA%E8%8A%82%E7%82%B9%E5%86%85%E5%AD%98\&#34;&gt;å›æ”¶å¤§å—å†…å­˜é“¾è¡¨ä¸Šçš„æŸä¸ªèŠ‚ç‚¹å†…å­˜&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;h2 id=\&#34;å®‰è£…ä¾èµ–\&#34;&gt;å®‰è£…ä¾èµ–&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;yum install libunwind-devel graphviz-devel ghostscript automake libtool -y&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;ç¼–è¯‘gpreftools\&#34;&gt;ç¼–è¯‘gpreftools&lt;/h2&gt;\n&lt;ol&gt;\n&lt;li&gt;æºä»£ç ï¼šhttps://github.com/gperftools/gperftools/archive/gperftools-2.7.tar.gz&lt;/li&gt;\n&lt;li&gt;ç¼–è¯‘å®‰è£…\n&lt;ul&gt;\n&lt;li&gt;./autogen.sh&lt;/li&gt;\n&lt;li&gt;./configure&lt;/li&gt;\n&lt;li&gt;make &amp;amp;&amp;amp; make install&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;å¯¼å‡ºLD_LIBRARY_PATH\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;export LD_LIBRARY_PATH=&amp;quot;$LD_LIBRARY_PATH:/usr/local/lib&amp;quot;&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;nginxä½¿ç”¨tcmallocå’Œå¯ç”¨google_perftools_moduleæ¨¡å—\&#34;&gt;nginxä½¿ç”¨tcmallocå’Œå¯ç”¨google_perftools_moduleæ¨¡å—&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;--with-ld-opt=-ltcmalloc --with-google_perftools_module&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&#34;,&#34;fileName&#34;:&#34;gperftools-fen-xi-nginx&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;gperftoolsåˆ†æNginx&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;Nginx&#34;,&#34;slug&#34;:&#34;ZUZBgmRmp&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://xly0713.github.io/tag/ZUZBgmRmp/&#34;}],&#34;date&#34;:&#34;2020-02-09 19:00:55&#34;,&#34;dateFormat&#34;:&#34;2020-02-09&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://xly0713.github.io/post/gperftools-fen-xi-nginx/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:21000,&#34;words&#34;:68,&#34;minutes&#34;:1},&#34;description&#34;:&#34;å®‰è£…ä¾èµ–\n\nyum install libunwind-devel graphviz-devel ghostscript automake libtool -y\n\nç¼–è¯‘gpreftools\n\næºä»£ç ï¼šhttps://github.com/g...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96\&#34;&gt;å®‰è£…ä¾èµ–&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%BC%96%E8%AF%91gpreftools\&#34;&gt;ç¼–è¯‘gpreftools&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#nginx%E4%BD%BF%E7%94%A8tcmalloc%E5%92%8C%E5%90%AF%E7%94%A8google_perftools_module%E6%A8%A1%E5%9D%97\&#34;&gt;nginxä½¿ç”¨tcmallocå’Œå¯ç”¨google_perftools_moduleæ¨¡å—&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹tcpåè®®åŸºç¡€çŸ¥è¯†çš„æ•´ç†ä»‹ç»ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;tcpå»ºè¿-æ–­è¿\&#34;&gt;tcpå»ºè¿ã€æ–­è¿&lt;/h2&gt;\n&lt;h3 id=\&#34;ç¤ºæ„å›¾\&#34;&gt;ç¤ºæ„å›¾&lt;/h3&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;1\&#34;&gt;&lt;img src=\&#34;https://xly0713.github.io/post-images/1586241639078.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h3 id=\&#34;ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹\&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;é˜²æ­¢å¤±æ•ˆçš„è¿æ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ã€‚&lt;/li&gt;\n&lt;li&gt;å…·ä½“æè¿°ï¼šå¦‚æœclientå‘é€çš„è¿æ¥è¯·æ±‚SYNåŒ…åœ¨ç½‘ç»œä¸­æ»ç•™äº†è¾ƒé•¿æ—¶é—´ï¼Œserveræœ€ç»ˆä»ä¼šæ”¶åˆ°å¹¶å‘å›è¿æ¥ç¡®è®¤SYN+ACKã€‚è€Œclientç­‰å¾…ä¸€ä¸ªè¶…æ—¶æ—¶é—´åï¼Œè®¤ä¸ºåˆšæ‰æ»ç•™çš„è¿æ¥è¯·æ±‚åŒ…ä¸¢å¤±äº†ï¼Œåˆ™ä¼šé‡æ–°å‘é€SYNåŒ…å‘èµ·è¿æ¥è¯·æ±‚ã€‚å¦‚æœä¸è¿›è¡Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆserveræ”¶åˆ°æ»ç•™çš„SYNåŒ…å°±æ‰“å¼€çš„è¿æ¥æ˜¯æ— æ•ˆçš„ï¼›å¦‚æœæœ‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆclientä¼šå¿½ç•¥serverå¯¹æ»ç•™çš„SYNåŒ…çš„å“åº”SYN+ACKï¼Œä¸å›å¤ACKåŒ…ï¼Œserveræ”¶ä¸åˆ°ç¬¬ä¸‰æ¬¡æ¡æ‰‹ACKåŒ…å°±ä¸ä¼šæ–°å»ºè¿æ¥ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&#34;tcpé¢å‘è¿æ¥ä»€ä¹ˆå«ä¹‰\&#34;&gt;tcpé¢å‘è¿æ¥ä»€ä¹ˆå«ä¹‰ï¼Ÿ&lt;/h3&gt;\n&lt;p&gt;ä¸ºäº†åœ¨clientå’Œserveré—´ç»´æŠ¤è¿æ¥ï¼Œéœ€å»ºç«‹ä¸€å®šçš„æ•°æ®ç»“æ„æ¥ç»´æŠ¤åŒæ–¹çš„äº¤äº’çŠ¶æ€ï¼Œç”¨è¿™æ ·çš„æ•°æ®ç»“æ„æ¥ä¿è¯é¢å‘è¿æ¥çš„ç‰¹æ€§ã€‚&lt;/p&gt;\n&lt;h3 id=\&#34;ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹\&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ&lt;/h3&gt;\n&lt;p&gt;ä¸€ç«¯å‘é€FINåŒ…è¯·æ±‚é‡Šæ”¾è¿æ¥ï¼Œå¯¹ç«¯æ”¶åˆ°è¿™ä¸ªFINæŠ¥æ–‡åè¿›å…¥äº†&lt;code&gt;CLOSE_WAIT&lt;/code&gt;çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€ä¸‹ï¼Œä»ç„¶å¯ä»¥å‘å¯¹æ–¹å‘é€æœªå‘é€å®Œæ¯•çš„æ•°æ®ï¼Œæ•°æ®å‘é€å®Œæ¯•åä¹Ÿè¦å‘å¯¹ç«¯å‘é€FINæŠ¥æ–‡é‡Šæ”¾è¿æ¥ï¼Œå¿˜äº†å‘FINåŒ…(è°ƒç”¨close())ä¼šå¯¼è‡´bugã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒTCPæ˜¯å…¨åŒå·¥ä¼ è¾“ï¼Œä¸¤ç«¯éƒ½å¿…é¡»å‘é€FINåŒ…ï¼Œæ‰èƒ½å®Œå…¨æ–­å¼€è¿æ¥ã€‚&lt;/p&gt;\n&lt;h3 id=\&#34;time_waitçŠ¶æ€\&#34;&gt;TIME_WAITçŠ¶æ€&lt;/h3&gt;\n&lt;p&gt;ä¸»åŠ¨å‘é€FINåŒ…çš„ä¸€ç«¯ï¼Œåœ¨æ”¶åˆ°å¯¹ç«¯çš„FINæŠ¥æ–‡åè¿›å…¥&lt;code&gt;TIME_WAIT&lt;/code&gt;çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ä¸€èˆ¬è¦ä¿æŒä¸€ä¸ªè¾ƒé•¿çš„æ—¶é—´2MSLã€‚åŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;ç¡®ä¿æœ€åä¸€ä¸ªåº”ç­”FINçš„æŠ¥æ–‡ACKèƒ½å¤Ÿåˆ°è¾¾ã€‚å› ä¸ºå¦‚æœå¯¹ç«¯æ²¡æœ‰æ”¶åˆ°ACKåº”ç­”ï¼Œåˆ™ä¼šé‡å‘FINåŒ…ã€‚&lt;/li&gt;\n&lt;li&gt;è®©å½“å‰è¿æ¥åœ¨ç½‘ç»œä¸­å¯èƒ½çš„æ‰€æœ‰æŠ¥æ–‡è¾¾åˆ°ç”Ÿå­˜æœŸä¸Šé™åæ¶ˆå¤±ï¼Œä½¿å¾—ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸ä¼šæ”¶åˆ°æ—§çš„è¿æ¥çš„æ•°æ®ã€‚&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;ä¸‰æ¬¡æ¡æ‰‹å†…æ ¸å®ç°åŸç†ç¤ºæ„å›¾\&#34;&gt;ä¸‰æ¬¡æ¡æ‰‹å†…æ ¸å®ç°åŸç†ç¤ºæ„å›¾&lt;/h2&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;2\&#34;&gt;&lt;img src=\&#34;https://xly0713.github.io/post-images/1586239797212.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&lt;h3 id=\&#34;é˜Ÿåˆ—é•¿åº¦é…ç½®\&#34;&gt;é˜Ÿåˆ—é•¿åº¦é…ç½®&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;SYNé˜Ÿåˆ—é•¿åº¦é…ç½®: &lt;code&gt;net.ipv4.tcp_max_syn_backlog = 8192 #SYN_RCVDçŠ¶æ€è¿æ¥çš„æœ€å¤§ä¸ªæ•°&lt;/code&gt;;&lt;/li&gt;\n&lt;li&gt;ACCEPTé˜Ÿåˆ—é•¿åº¦ï¼š\n&lt;ul&gt;\n&lt;li&gt;ç³»ç»Ÿå…¨å±€ï¼š &lt;code&gt;net.core.somaxconn = 262144 #ç³»ç»Ÿå…¨å±€ACCPETé˜Ÿåˆ—æœ€å¤§é•¿åº¦çš„é…ç½®&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;åº”ç”¨å±‚: socket API listenä¼ å‚æ§åˆ¶&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&#34;synæ”»å‡»\&#34;&gt;SYNæ”»å‡»&lt;/h3&gt;\n&lt;p&gt;æ”»å‡»è€…è¿…é€Ÿä¼ªé€ ä¸åŒIPåœ°å€çš„SYNæŠ¥æ–‡ï¼Œå¿«é€Ÿå æ»¡SYNé˜Ÿåˆ—ï¼Œä½¿å¾—æ­£å¸¸çš„SYNåŒ…æ— æ³•åŠ å…¥é˜Ÿåˆ—ã€‚&lt;/p&gt;\n&lt;h4 id=\&#34;åº”å¯¹synæ”»å‡»çš„å‚æ•°\&#34;&gt;åº”å¯¹SYNæ”»å‡»çš„å‚æ•°&lt;/h4&gt;\n&lt;p&gt;&lt;code&gt;net.core.netdev_max_backlog = 262144 #æ¥æ”¶è‡ªç½‘å¡ã€ä½†æ˜¯æœªè¢«å†…æ ¸åè®®æ ˆå¤„ç†çš„IPæŠ¥æ–‡é˜Ÿåˆ—é•¿åº¦&lt;/code&gt;&lt;br&gt;\n&lt;code&gt;net.ipv4.tcp_max_syn_backlog = 8192 #SYN_RCVDçŠ¶æ€(åŠ)è¿æ¥çš„æœ€å¤§ä¸ªæ•°&lt;/code&gt;&lt;br&gt;\n&lt;code&gt;net.ipv4.tcp_abort_on_overflow = 1 #è®¾ç½®ä¸º1æ—¶è¡¨ç¤º: é˜Ÿåˆ—æ»¡åˆ™å“åº”RSTåŒ…ï¼Œä¸¢å¼ƒè¿æ¥&lt;/code&gt;&lt;/p&gt;\n&lt;h4 id=\&#34;tcp_syncookies\&#34;&gt;tcp_syncookies&lt;/h4&gt;\n&lt;p&gt;&lt;code&gt;net.ipv4.tcp_syncookies = 1 #å¯ç”¨tcp cookie, ä½¿å¾—SYNé˜Ÿåˆ—æ»¡ä»èƒ½å»ºç«‹è¿æ¥&lt;/code&gt;&lt;/p&gt;\n&lt;h3 id=\&#34;æ§åˆ¶tcpä¸‰æ¬¡æ¡æ‰‹çš„å‚æ•°\&#34;&gt;æ§åˆ¶TCPä¸‰æ¬¡æ¡æ‰‹çš„å‚æ•°&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;p&gt;SYN_SENTçŠ¶æ€&lt;br&gt;\n&lt;code&gt;net.ip4.tcp_syn_retries = 6 #ä¸»åŠ¨å»ºç«‹è¿æ¥ï¼Œå‘é€SYNçš„é‡è¯•æ¬¡æ•°&lt;/code&gt;&lt;br&gt;\n&lt;code&gt;net.ipv4.ip_local_port_range = 32768 60999 #å»ºç«‹è¿æ¥æ—¶çš„æœ¬åœ°ç«¯å£å¯é€‰èŒƒå›´&lt;/code&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;SYN_RCVDçŠ¶æ€&lt;br&gt;\n&lt;code&gt;net.ipv4.tcp_max_syn_backlog = 8192 #SYN_RCVDçŠ¶æ€(åŠ)è¿æ¥çš„æœ€å¤§ä¸ªæ•°&lt;/code&gt;&lt;br&gt;\n&lt;code&gt;net.ipv4.tcp_synack_retries = 3 #è¢«åŠ¨å»ºç«‹è¿æ¥æ—¶ï¼Œå‘é€SYN/ACKçš„é‡è¯•æ¬¡æ•°&lt;/code&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;tfotcp-fast-open\&#34;&gt;TFO(TCP Fast Open)&lt;/h2&gt;\n&lt;p&gt;é…ç½®: &lt;code&gt;net.ipv4.tcp_fastopen&lt;/code&gt;ã€‚ï¼ˆ&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šå†…æ ¸ç‰ˆæœ¬è¦æ±‚åœ¨Linux 3.7ä»¥ä¸Šï¼‰&lt;br&gt;\nå¯é€‰å€¼ï¼š&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;0: å…³é—­(é»˜è®¤)&lt;/li&gt;\n&lt;li&gt;1: ä½œä¸ºå®¢æˆ·ç«¯æ—¶å¯ä»¥ä½¿ç”¨TFO&lt;/li&gt;\n&lt;li&gt;2: ä½œä¸ºæœåŠ¡ç«¯æ—¶å¯ä»¥ä½¿ç”¨TFO&lt;/li&gt;\n&lt;li&gt;3: éƒ½å¯ä»¥ä½¿ç”¨TFOï¼Œæ— è®ºæ˜¯ä½œä¸ºæœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&#34;ç¤ºæ„å›¾-2\&#34;&gt;ç¤ºæ„å›¾&lt;/h3&gt;\n&lt;figure data-type=\&#34;image\&#34; tabindex=\&#34;3\&#34;&gt;&lt;img src=\&#34;https://xly0713.github.io/post-images/1586580242109.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/figure&gt;\n&#34;,&#34;fileName&#34;:&#34;tcp-xie-yi&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹tcpåè®®åŸºç¡€çŸ¥è¯†çš„æ•´ç†ä»‹ç»ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;TCPåè®®åŸºç¡€&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;ç½‘ç»œåè®®&#34;,&#34;slug&#34;:&#34;Q1k2X6rnU&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://xly0713.github.io/tag/Q1k2X6rnU/&#34;}],&#34;date&#34;:&#34;2020-02-02 20:41:15&#34;,&#34;dateFormat&#34;:&#34;2020-02-02&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://xly0713.github.io/post/tcp-xie-yi/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;4 min read&#34;,&#34;time&#34;:196000,&#34;words&#34;:882,&#34;minutes&#34;:4},&#34;description&#34;:&#34;æœ¬æ–‡æ˜¯å¯¹tcpåè®®åŸºç¡€çŸ¥è¯†çš„æ•´ç†ä»‹ç»ã€‚\n\ntcpå»ºè¿ã€æ–­è¿\nç¤ºæ„å›¾\n\nä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ\n\né˜²æ­¢å¤±æ•ˆçš„è¿æ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ã€‚\nå…·ä½“æè¿°ï¼šå¦‚æœclientå‘é€çš„è¿æ¥è¯·æ±‚SYNåŒ…åœ¨ç½‘ç»œä¸­æ»ç•™äº†è¾ƒé•¿æ—¶é—´ï¼Œserveræœ€ç»ˆä»ä¼šæ”¶åˆ°å¹¶å‘å›è¿æ¥ç¡®è®¤SY...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#tcp%E5%BB%BA%E8%BF%9E-%E6%96%AD%E8%BF%9E\&#34;&gt;tcpå»ºè¿ã€æ–­è¿&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%A4%BA%E6%84%8F%E5%9B%BE\&#34;&gt;ç¤ºæ„å›¾&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B\&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#tcp%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E4%BB%80%E4%B9%88%E5%90%AB%E4%B9%89\&#34;&gt;tcpé¢å‘è¿æ¥ä»€ä¹ˆå«ä¹‰ï¼Ÿ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B\&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#time_wait%E7%8A%B6%E6%80%81\&#34;&gt;TIME_WAITçŠ¶æ€&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%86%85%E6%A0%B8%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E7%A4%BA%E6%84%8F%E5%9B%BE\&#34;&gt;ä¸‰æ¬¡æ¡æ‰‹å†…æ ¸å®ç°åŸç†ç¤ºæ„å›¾&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E9%98%9F%E5%88%97%E9%95%BF%E5%BA%A6%E9%85%8D%E7%BD%AE\&#34;&gt;é˜Ÿåˆ—é•¿åº¦é…ç½®&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#syn%E6%94%BB%E5%87%BB\&#34;&gt;SYNæ”»å‡»&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%BA%94%E5%AF%B9syn%E6%94%BB%E5%87%BB%E7%9A%84%E5%8F%82%E6%95%B0\&#34;&gt;åº”å¯¹SYNæ”»å‡»çš„å‚æ•°&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#tcp_syncookies\&#34;&gt;tcp_syncookies&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E6%8E%A7%E5%88%B6tcp%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E7%9A%84%E5%8F%82%E6%95%B0\&#34;&gt;æ§åˆ¶TCPä¸‰æ¬¡æ¡æ‰‹çš„å‚æ•°&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#tfotcp-fast-open\&#34;&gt;TFO(TCP Fast Open)&lt;/a&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E7%A4%BA%E6%84%8F%E5%9B%BE-2\&#34;&gt;ç¤ºæ„å›¾&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹DNSåè®®çš„ç®€å•æ•´ç†ä»‹ç»ã€‚&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h2 id=\&#34;dnsæ˜¯ä»€ä¹ˆ\&#34;&gt;DNSæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;\n&lt;p&gt;DNSæ˜¯äº’è”ç½‘ä¸–ç•Œçš„åœ°å€è–„ï¼Œç±»ä¼¼äºç”µè¯æœ¬ï¼Œä¸»è¦æä¾›å°†åŸŸåæ˜ å°„åˆ°IPåœ°å€çš„åŠŸèƒ½ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;dnsçš„æ ‘çŠ¶å±‚æ¬¡ç»“æ„\&#34;&gt;DNSçš„æ ‘çŠ¶å±‚æ¬¡ç»“æ„&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;ç¬¬ä¸€å±‚: æ ¹DNSæœåŠ¡å™¨ï¼Œè´Ÿè´£è¿”å›é¡¶çº§DNS(TLD)æœåŠ¡å™¨çš„IPåœ°å€ã€‚ç›®å‰å…¨ä¸–ç•Œæœ‰13å°æœåŠ¡èŠ‚ç‚¹ã€‚&lt;/li&gt;\n&lt;li&gt;ç¬¬äºŒå±‚: TLDæœåŠ¡å™¨ï¼Œè´Ÿè´£è¿”å›æƒå¨DNSæœåŠ¡å™¨çš„IPåœ°å€ã€‚&lt;/li&gt;\n&lt;li&gt;ç¬¬ä¸‰å±‚: æƒå¨DNSæœåŠ¡å™¨ï¼Œè´Ÿè´£è¿”å›ç›¸åº”ä¸»æœºæˆ–åŸŸåçš„IPåœ°å€ã€‚&lt;br&gt;\n&lt;img src=\&#34;https://xly0713.github.io/post-images/1586003718190.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;dnsçš„è§£ææµç¨‹\&#34;&gt;DNSçš„è§£ææµç¨‹&lt;/h2&gt;\n&lt;p&gt;åœ¨æœªå‘½ä¸­ç¼“å­˜çš„æƒ…å†µä¸‹ï¼ŒDNSå®ŒæˆåŸŸåçš„è§£æéœ€è¦ç»è¿‡å¦‚ä¸‹æ­¥éª¤:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥â€œexample.comâ€, æŸ¥è¯¢ç”±æœ¬åœ°DNSæœåŠ¡(&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;)è§£æå™¨æ¥æ”¶ã€‚&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;æŸ¥è¯¢&lt;strong&gt;æ ¹DNSåŸŸåæœåŠ¡å™¨&lt;/strong&gt;ã€‚&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;æ ¹DNSæœåŠ¡å™¨&lt;/strong&gt;ä½¿ç”¨&lt;strong&gt;é¡¶çº§DNS(TLD)æœåŠ¡å™¨&lt;/strong&gt;(ä¾‹å¦‚.comæˆ–.net)çš„åœ°å€å“åº”ç»™&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;ã€‚å¦‚ï¼šâ€œexample.comâ€ï¼Œåˆ™è¿”å›.com TLDçš„IPåœ°å€ã€‚&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;å‘.com&lt;strong&gt;é¡¶çº§DNS(TLD)æœåŠ¡å™¨&lt;/strong&gt;å‘å‡ºè¯·æ±‚ã€‚&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;é¡¶çº§DNS(TLD)æœåŠ¡å™¨&lt;/strong&gt;å“åº”&lt;strong&gt;æƒå¨DNSæœåŠ¡å™¨&lt;/strong&gt;çš„IPåœ°å€ã€‚&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;å‘&lt;strong&gt;æƒå¨DNSæœåŠ¡å™¨&lt;/strong&gt;ç¿»å‡ºè¯·æ±‚ã€‚&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;æƒå¨DNSæœåŠ¡å™¨&lt;/strong&gt;å“åº”example.comçš„IPåœ°å€ç»™&lt;strong&gt;é€’å½’æœåŠ¡å™¨&lt;/strong&gt;ã€‚&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;é€’å½’DNSæœåŠ¡å™¨&lt;/strong&gt;å°†example.comçš„IPåœ°å€å“åº”ç»™æµè§ˆå™¨ã€‚ï¼ˆ&lt;em&gt;DNSè§£æå®Œæˆ&lt;/em&gt;ï¼‰&lt;/li&gt;\n&lt;li&gt;æµè§ˆå™¨å‘example.comçš„IPåœ°å€å‘å‡ºHTTPè¯·æ±‚...&lt;br&gt;\n&lt;img src=\&#34;https://xly0713.github.io/post-images/1586005095657.png\&#34; alt=\&#34;\&#34; loading=\&#34;lazy\&#34;&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;dnsç¼“å­˜\&#34;&gt;DNSç¼“å­˜&lt;/h2&gt;\n&lt;p&gt;åœ¨æœªå‘½ä¸­ç¼“å­˜çš„æƒ…å½¢ä¸‹ï¼ŒDNSè§£æçš„æµç¨‹æ˜¯å¤æ‚ä¸”è€—æ—¶çš„ã€‚DNSæ•°æ®å¯ä»¥è¢«ç¼“å­˜åœ¨å¤šä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®å¯ä»¥åœ¨ä¸€æ®µæ—¶é—´å†…(è®°å½•ç”Ÿå­˜æ—¶é—´TTL)ç¼“å­˜DNSæ•°æ®è®°å½•:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;æµè§ˆå™¨DNSç¼“å­˜&lt;/li&gt;\n&lt;li&gt;æ“ä½œç³»ç»Ÿçº§DNSç¼“å­˜&lt;/li&gt;\n&lt;li&gt;é€’å½’DNSæœåŠ¡å™¨çº§åˆ«ç¼“å­˜ã€‚&lt;em&gt;å¦‚æœåŸŸåç¼“å­˜æœªå‘½ä¸­ï¼Œä½†æ˜¯å‘½ä¸­äº†è¯¥åŸŸåçš„NSè®°å½•ï¼Œåˆ™è·³è¿‡è¯·æ±‚æ ¹å’ŒTLDæœåŠ¡å™¨ï¼›å¦‚æœæ²¡æœ‰NSè®°å½•ï¼Œä½†æ˜¯å‘½ä¸­äº†TLDçš„è®°å½•ï¼Œåˆ™è·³è¿‡è¯·æ±‚æ ¹æœåŠ¡å™¨ï¼›å¦‚æœæ²¡æœ‰å‘½ä¸­TLDçš„è®°å½•ï¼Œåˆ™è¦å®Œæ•´èµ°å®Œè¿­ä»£è®¿é—®æ ¹DNSæœåŠ¡å™¨åˆ°æƒå¨æœåŠ¡å™¨è¿™ä¸€å…¨æµç¨‹äº†ã€‚&lt;/em&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;dnsè®°å½•ç±»å‹\&#34;&gt;DNSè®°å½•ç±»å‹&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;å¸¸è§ç±»å‹ï¼š&lt;/li&gt;\n&lt;/ul&gt;\n&lt;ol&gt;\n&lt;li&gt;Aè®°å½•: åŸŸåæ˜ å°„çš„IPv4åœ°å€ã€‚&lt;/li&gt;\n&lt;li&gt;CNAMEè®°å½•ï¼šåŸŸååˆ«åæ˜ å°„ï¼Œå°†åŸŸåæŒ‡å‘å¦å¤–ä¸€ä¸ªåŸŸåã€‚&lt;/li&gt;\n&lt;li&gt;NSè®°å½•ï¼šåŸŸåæ˜ å°„çš„æƒå¨æœåŠ¡å™¨è®°å½•ã€‚&lt;/li&gt;\n&lt;li&gt;AAAAè®°å½•ï¼šåŸŸåæ˜ å°„çš„IPv6åœ°å€ã€‚&lt;/li&gt;\n&lt;li&gt;MXè®°å½•ï¼šåŸŸåæ˜ å°„çš„é‚®ç®±æœåŠ¡å™¨åœ°å€ã€‚&lt;/li&gt;\n&lt;li&gt;TXTè®°å½•ï¼šå…è®¸ç®¡ç†å‘˜åœ¨è®°å½•ä¸­å­˜å‚¨æ–‡æœ¬ã€‚&lt;/li&gt;\n&lt;li&gt;SOAè®°å½•ï¼šå­˜å‚¨æœ‰å…³åŸŸçš„ç®¡ç†å‘˜ä¿¡æ¯ã€‚&lt;/li&gt;\n&lt;li&gt;SRVè®°å½•ï¼šæŒ‡å®šç‰¹å®šæœåŠ¡çš„ç«¯å£ã€‚&lt;/li&gt;\n&lt;li&gt;PTRè®°å½•ï¼šåœ¨åå‘æŸ¥è¯¢ä¸­æä¾›åŸŸåã€‚&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&#34;dnsåè®®æŠ¥æ–‡æ ¼å¼\&#34;&gt;DNSåè®®æŠ¥æ–‡æ ¼å¼&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;https://jocent.me/2017/06/18/dns-protocol-principle.html&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;èƒ¶æ°´è®°å½•glue-record\&#34;&gt;èƒ¶æ°´è®°å½•(Glue record)&lt;/h2&gt;\n&lt;p&gt;å½“ç»™&lt;strong&gt;åŸŸåA&lt;/strong&gt;é…ç½®NSè®°å½•æ—¶ï¼Œå¦‚æœNSè®°å½•ä¸º&lt;strong&gt;åŸŸåA&lt;/strong&gt;çš„å­åŸŸåï¼Œåˆ™å¿…é¡»é…ç½®NSè®°å½•çš„Aè®°å½•ã€‚&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;é€šå¸¸éœ€è¦åœ¨åŸŸåæä¾›å•†å“ªé‡Œç”³è¯·ä¸¤ä¸ªåŸŸåï¼Œè€Œä¸å»ºè®®é‡‡ç”¨èƒ¶æ°´è®°å½•æ–¹å¼ã€‚&lt;/li&gt;\n&lt;li&gt;å‚è€ƒé“¾æ¥ï¼šhttps://www.jianshu.com/p/7d69ec2976c7&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;dnsä¼˜ç§€çš„goå¼€æºé¡¹ç›®\&#34;&gt;DNSä¼˜ç§€çš„goå¼€æºé¡¹ç›®&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;https://github.com/miekg/dns&lt;/li&gt;\n&lt;li&gt;https://github.com/abh/geodns ï¼ˆä½¿ç”¨miekg/dnsï¼‰&lt;/li&gt;\n&lt;/ul&gt;\n&#34;,&#34;fileName&#34;:&#34;dns&#34;,&#34;abstract&#34;:&#34;&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹DNSåè®®çš„ç®€å•æ•´ç†ä»‹ç»ã€‚&lt;/p&gt;\n&#34;,&#34;title&#34;:&#34;DNSåè®®åŸºç¡€&#34;,&#34;tags&#34;:[{&#34;name&#34;:&#34;ç½‘ç»œåè®®&#34;,&#34;slug&#34;:&#34;Q1k2X6rnU&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://xly0713.github.io/tag/Q1k2X6rnU/&#34;},{&#34;name&#34;:&#34;GSLB&#34;,&#34;slug&#34;:&#34;pRwAbJURI&#34;,&#34;used&#34;:true,&#34;link&#34;:&#34;https://xly0713.github.io/tag/pRwAbJURI/&#34;}],&#34;date&#34;:&#34;2020-01-30 20:31:48&#34;,&#34;dateFormat&#34;:&#34;2020-01-30&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://xly0713.github.io/post/dns/&#34;,&#34;hideInList&#34;:false,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;3 min read&#34;,&#34;time&#34;:176000,&#34;words&#34;:794,&#34;minutes&#34;:3},&#34;description&#34;:&#34;æœ¬æ–‡æ˜¯å¯¹DNSåè®®çš„ç®€å•æ•´ç†ä»‹ç»ã€‚\n\nDNSæ˜¯ä»€ä¹ˆï¼Ÿ\nDNSæ˜¯äº’è”ç½‘ä¸–ç•Œçš„åœ°å€è–„ï¼Œç±»ä¼¼äºç”µè¯æœ¬ï¼Œä¸»è¦æä¾›å°†åŸŸåæ˜ å°„åˆ°IPåœ°å€çš„åŠŸèƒ½ã€‚\nDNSçš„æ ‘çŠ¶å±‚æ¬¡ç»“æ„\n\nç¬¬ä¸€å±‚: æ ¹DNSæœåŠ¡å™¨ï¼Œè´Ÿè´£è¿”å›é¡¶çº§DNS(TLD)æœåŠ¡å™¨çš„IPåœ°å€ã€‚ç›®å‰å…¨ä¸–ç•Œ...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#dns%E6%98%AF%E4%BB%80%E4%B9%88\&#34;&gt;DNSæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#dns%E7%9A%84%E6%A0%91%E7%8A%B6%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84\&#34;&gt;DNSçš„æ ‘çŠ¶å±‚æ¬¡ç»“æ„&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#dns%E7%9A%84%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B\&#34;&gt;DNSçš„è§£ææµç¨‹&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#dns%E7%BC%93%E5%AD%98\&#34;&gt;DNSç¼“å­˜&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#dns%E8%AE%B0%E5%BD%95%E7%B1%BB%E5%9E%8B\&#34;&gt;DNSè®°å½•ç±»å‹&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#dns%E5%8D%8F%E8%AE%AE%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F\&#34;&gt;DNSåè®®æŠ¥æ–‡æ ¼å¼&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%83%B6%E6%B0%B4%E8%AE%B0%E5%BD%95glue-record\&#34;&gt;èƒ¶æ°´è®°å½•(Glue record)&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#dns%E4%BC%98%E7%A7%80%E7%9A%84go%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE\&#34;&gt;DNSä¼˜ç§€çš„goå¼€æºé¡¹ç›®&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;},{&#34;content&#34;:&#34;&lt;blockquote&gt;\n&lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h2 id=\&#34;å…³äºæœ¬ç«™\&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/h2&gt;\n&lt;p&gt;æœ¬ç«™ä¸»è¦ç”¨æ¥è®°å½•ä¸€äº›æŠ€æœ¯ï¼Œå¸®åŠ©è‡ªå·±æ•´ç†é›¶ç¢çš„çŸ¥è¯†ï¼Œå¸Œæœ›å¯¹ä»–äººæœ‰æ‰€å¸®åŠ©ã€‚æ¬¢è¿&lt;a href=\&#34;/atom.xml\&#34;&gt;RSS&lt;/a&gt;è®¢é˜…æœ¬ç«™ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;åšä¸»æ˜¯è°\&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/h2&gt;\n&lt;p&gt;åšä¸»æ˜¯ä¸€ååå°ç ”å‘æ”»åŸç‹®ï¼Œå…³æ³¨äº‘è®¡ç®—ç›¸å…³é¢†åŸŸï¼Œç›®å‰ä¸“æ³¨äºCDNæŠ€æœ¯å’Œç›´æ’­æŠ€æœ¯ã€‚&lt;/p&gt;\n&lt;h2 id=\&#34;è”ç³»æˆ‘å‘€\&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;é‚®ä»¶: xly880713@gmail.com&lt;/li&gt;\n&lt;/ul&gt;\n&#34;,&#34;fileName&#34;:&#34;about&#34;,&#34;abstract&#34;:&#34;&#34;,&#34;title&#34;:&#34;å…³äº&#34;,&#34;tags&#34;:[],&#34;date&#34;:&#34;2019-01-25 19:09:48&#34;,&#34;dateFormat&#34;:&#34;2019-01-25&#34;,&#34;feature&#34;:&#34;&#34;,&#34;link&#34;:&#34;https://xly0713.github.io/post/about/&#34;,&#34;hideInList&#34;:true,&#34;isTop&#34;:false,&#34;stats&#34;:{&#34;text&#34;:&#34;1 min read&#34;,&#34;time&#34;:21000,&#34;words&#34;:105,&#34;minutes&#34;:1},&#34;description&#34;:&#34;\næ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤\n\nğŸ  å…³äºæœ¬ç«™\næœ¬ç«™ä¸»è¦ç”¨æ¥è®°å½•ä¸€äº›æŠ€æœ¯ï¼Œå¸®åŠ©è‡ªå·±æ•´ç†é›¶ç¢çš„çŸ¥è¯†ï¼Œå¸Œæœ›å¯¹ä»–äººæœ‰æ‰€å¸®åŠ©ã€‚æ¬¢è¿RSSè®¢é˜…æœ¬ç«™ã€‚\nğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°\nåšä¸»æ˜¯ä¸€ååå°ç ”å‘æ”»åŸç‹®ï¼Œå…³æ³¨äº‘è®¡ç®—ç›¸å…³é¢†åŸŸï¼Œç›®å‰ä¸“æ³¨äºCDNæŠ€æœ¯...&#34;,&#34;toc&#34;:&#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99\&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E5%8D%9A%E4%B8%BB%E6%98%AF%E8%B0%81\&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#%E8%81%94%E7%B3%BB%E6%88%91%E5%91%80\&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;}]";
  // var json = escape.substr(1, escape.length - 2);
  // var datas = json.split(',');
  // for (let i=0; i < datas.length; i++) {
  //   let item = datas[i];
  //   let attrs = item.split('34;:&#34')
  //   debugger
  //   console.log(datas[i])
  // }
  let escapeMap = new Map();
  escapeMap.set('&#34;', '"');
  escapeMap.set('&gt;', '>');
  escapeMap.set('&#39;', "'");
  escapeMap.set('&lt;', '<');
  escapeMap.set('&quot;', '"');
  escapeMap.set('&amp;', '&');
</script> -->

<!-- <script src="/media/js/mouse/peace.js"></script> -->

</html>